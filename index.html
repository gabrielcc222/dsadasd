<!DOCTYPE html>
<html lang="pt-br" class="light-theme">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AnimeBlog - Seu Portal de Animes</title>
    <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --bg-primary: #f5f5f5;
            --bg-secondary: #fff;
            --text-primary: #333;
            --text-secondary: #5f6368;
            --border-color: #eee;
            --card-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
            --hover-bg: #f5f5f5;
            --accent-color: #1a73e8;
            --accent-secondary: #ff6d00;
            --input-bg: #fff;
            --divider-color: #eee;
            --card-bg: #fff;
            --modal-bg: #fff;
            --modal-overlay: rgba(0, 0, 0, 0.5);
            --image-modal-bg: rgba(0, 0, 0, 0.9);
            --genre-bg: #e0e0e0;
            --genre-active-bg: #1a73e8;
            --genre-active-text: #fff;
            --tab-active-color: #1a73e8;
            --tab-active-border: #1a73e8;
            --favorite-icon-color: #ff6d00;
            --pagination-active-bg: #1a73e8;
            --pagination-active-text: #fff;
            --loading-bg: #f5f5f5;
            --loading-bar: #1a73e8;
            --button-primary-bg: #1a73e8;
            --button-primary-text: #fff;
            --button-secondary-bg: transparent;
            --button-secondary-text: #5f6368;
            --button-secondary-border: #dadce0;
            --anime-meta-bg: #e0e0e0;
            --anime-meta-text: #5f6368;
            --review-bg: #f5f5f5;
            --platform-bg: #f5f5f5;
            --platform-text: #5f6368;
            --header-bg: #f5f5f5;
        }

        /* Variáveis de tema - Dark */
        .dark-theme {
            --bg-primary: #121212;
            --bg-secondary: #1e1e1e;
            --text-primary: #e0e0e0;
            --text-secondary: #a0a0a0;
            --border-color: #333;
            --card-shadow: 0 1px 3px rgba(0, 0, 0, 0.3);
            --hover-bg: #2c2c2c;
            --accent-color: #4285f4;
            --accent-secondary: #ff9800;
            --input-bg: #2c2c2c;
            --divider-color: #333;
            --card-bg: #1e1e1e;
            --modal-bg: #1e1e1e;
            --modal-overlay: rgba(0, 0, 0, 0.7);
            --image-modal-bg: rgba(0, 0, 0, 0.95);
            --genre-bg: #2c2c2c;
            --genre-active-bg: #4285f4;
            --genre-active-text: #fff;
            --tab-active-color: #4285f4;
            --tab-active-border: #4285f4;
            --favorite-icon-color: #ff9800;
            --pagination-active-bg: #4285f4;
            --pagination-active-text: #fff;
            --loading-bg: #2c2c2c;
            --loading-bar: #4285f4;
            --button-primary-bg: #4285f4;
            --button-primary-text: #fff;
            --button-secondary-bg: transparent;
            --button-secondary-text: #a0a0a0;
            --button-secondary-border: #444;
            --anime-meta-bg: #2c2c2c;
            --anime-meta-text: #a0a0a0;
            --review-bg: #2c2c2c;
            --platform-bg: #2c2c2c;
            --platform-text: #a0a0a0;
            --header-bg: #1e1e1e;
        }

        /* Transição suave para mudança de tema */
        * {
            transition: background-color 0.3s ease, color 0.3s ease, border-color 0.3s ease, box-shadow 0.3s ease;
        }

        /* Estilos gerais */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Roboto', sans-serif;
        }

        body {
            background-color: var(--bg-primary);
            color: var(--text-primary);
        }

        .container {
            display: flex;
            min-height: 100vh;
        }

        /* Estilos da sidebar (igual ao Blogger) */
        .sidebar {
            width: 250px;
            background-color: var(--bg-secondary);
            box-shadow: var(--card-shadow);
            padding: 20px 0;
            height: 100vh;
            position: fixed;
            overflow-y: auto;
            z-index: 100;
            transition: transform 0.3s ease;
        }

        .logo {
            display: flex;
            align-items: center;
            padding: 0 20px 20px;
            border-bottom: 1px solid var(--border-color);
        }

        .logo img {
            width: 40px;
            height: 40px;
            margin-right: 10px;
            border-radius: 50%;
        }

        .logo span {
            font-size: 18px;
            font-weight: 500;
            color: var(--text-primary);
        }

        .menu {
            margin-top: 20px;
        }

        .menu-item {
            display: flex;
            align-items: center;
            padding: 12px 20px;
            color: var(--text-secondary);
            text-decoration: none;
            transition: background-color 0.3s;
            cursor: pointer;
        }

        .menu-item:hover {
            background-color: var(--hover-bg);
        }

        .menu-item.active {
            color: var(--accent-secondary);
        }

        .menu-item i {
            margin-right: 15px;
            font-size: 20px;
        }

        .menu-item.view-blog {
            color: var(--accent-color);
        }

        .divider {
            height: 1px;
            background-color: var(--divider-color);
            margin: 10px 0;
        }

        .footer {
            padding: 20px;
            font-size: 12px;
            color: var(--text-secondary);
            border-top: 1px solid var(--border-color);
            margin-top: 20px;
        }

        .footer a {
            color: var(--text-secondary);
            text-decoration: none;
        }

        /* Conteúdo principal */
        .main-content {
            flex: 1;
            margin-left: 250px;
            padding: 20px;
            transition: margin-left 0.3s ease;
        }

        .header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px 0;
            margin-bottom: 30px;
        }

        /* Botão de menu para mobile */
        .menu-toggle {
            display: none;
            background: none;
            border: none;
            color: var(--text-primary);
            font-size: 24px;
            cursor: pointer;
            padding: 5px;
            margin-right: 10px;
        }

        .search-bar {
            display: flex;
            align-items: center;
            background-color: var(--input-bg);
            border-radius: 24px;
            padding: 8px 16px;
            width: 400px;
            box-shadow: var(--card-shadow);
        }

        .search-bar i {
            color: var(--text-secondary);
            margin-right: 10px;
        }

        .search-bar input {
            border: none;
            outline: none;
            width: 100%;
            font-size: 16px;
            background-color: transparent;
            color: var(--text-primary);
        }

        /* Header right section with theme toggle and profile */
        .header-right {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        /* Theme toggle button in header */
        .theme-toggle-header {
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background-color: var(--bg-secondary);
            box-shadow: var(--card-shadow);
            transition: all 0.3s ease;
        }

        .theme-toggle-header:hover {
            background-color: var(--hover-bg);
        }

        .theme-toggle-header svg {
            width: 24px;
            height: 24px;
            fill: var(--text-secondary);
        }

        .sun-icon {
            display: none;
        }

        .moon-icon {
            display: block;
        }

        .dark-theme .sun-icon {
            display: block;
        }

        .dark-theme .moon-icon {
            display: none;
        }

        .user-profile {
            cursor: pointer;
        }

        .avatar img {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            object-fit: cover;
        }

        /* Popup de perfil */
        .profile-popup {
            position: absolute;
            top: 70px;
            right: 20px;
            background-color: var(--modal-bg);
            border-radius: 8px;
            box-shadow: var(--card-shadow);
            width: 350px;
            z-index: 1000;
            display: none;
        }

        .popup-header {
            padding: 16px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-bottom: 1px solid var(--border-color);
        }

        .popup-header span {
            font-size: 14px;
            color: var(--text-secondary);
        }

        .close-popup {
            cursor: pointer;
            color: var(--text-secondary);
        }

        .popup-content {
            padding: 20px;
            text-align: center;
        }

        .avatar-large {
            position: relative;
            width: 80px;
            height: 80px;
            margin: 0 auto 10px;
        }

        .avatar-large img {
            width: 100%;
            height: 100%;
            border-radius: 50%;
        }

        .edit-icon {
            position: absolute;
            bottom: 0;
            right: 0;
            background-color: var(--bg-secondary);
            border-radius: 50%;
            padding: 4px;
            box-shadow: var(--card-shadow);
            cursor: pointer;
        }

        .greeting {
            font-size: 18px;
            margin-bottom: 20px;
            color: var(--text-primary);
        }

        .manage-account {
            background-color: transparent;
            border: 1px solid var(--button-secondary-border);
            border-radius: 24px;
            padding: 10px 20px;
            font-size: 14px;
            color: var(--accent-color);
            cursor: pointer;
            margin-bottom: 20px;
            width: 100%;
        }

        .account-actions {
            display: flex;
            justify-content: space-between;
            margin-bottom: 20px;
        }

        .add-account, .logout {
            display: flex;
            align-items: center;
            justify-content: center;
            background-color: transparent;
            border: none;
            padding: 10px;
            font-size: 14px;
            color: var(--text-secondary);
            cursor: pointer;
            flex: 1;
        }

        .add-account i, .logout i {
            margin-right: 5px;
        }

        .popup-footer {
            font-size: 12px;
            color: var(--text-secondary);
        }

        .popup-footer a {
            color: var(--text-secondary);
            text-decoration: none;
        }

        /* Conteúdo dos animes */
        .content {
            background-color: var(--card-bg);
            border-radius: 8px;
            padding: 20px;
            box-shadow: var(--card-shadow);
            margin-bottom: 30px;
        }

        h1, h2 {
            margin-bottom: 20px;
            color: var(--text-primary);
        }

        .anime-grid, .episodes-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 40px;
        }

        .anime-card {
            background-color: var(--card-bg);
            border-radius: 8px;
            overflow: hidden;
            box-shadow: var(--card-shadow);
            transition: transform 0.3s, box-shadow 0.3s;
            cursor: pointer;
        }

        .anime-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
        }

        .anime-image {
            width: 100%;
            height: 280px;
            object-fit: cover;
        }

        .anime-info {
            padding: 15px;
        }

        .anime-title {
            font-size: 16px;
            font-weight: 500;
            margin-bottom: 5px;
            display: -webkit-box;
            -webkit-line-clamp: 2;
            -webkit-box-orient: vertical;
            overflow: hidden;
            color: var(--text-primary);
        }

        .anime-details {
            font-size: 14px;
            color: var(--text-secondary);
            display: flex;
            justify-content: space-between;
        }

        .episode-card {
            display: flex;
            background-color: var(--card-bg);
            border-radius: 8px;
            overflow: hidden;
            box-shadow: var(--card-shadow);
            cursor: pointer;
        }

        .episode-card:hover {
            transform: translateY(-3px);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
        }

        .episode-image {
            width: 120px;
            height: 80px;
            object-fit: cover;
        }

        .episode-info {
            padding: 10px;
            flex: 1;
        }

        .episode-title {
            font-size: 14px;
            font-weight: 500;
            margin-bottom: 5px;
            display: -webkit-box;
            -webkit-line-clamp: 1;
            -webkit-box-orient: vertical;
            overflow: hidden;
            color: var(--text-primary);
        }

        .episode-number {
            font-size: 12px;
            color: var(--text-secondary);
        }

        .loading {
            grid-column: 1 / -1;
            text-align: center;
            padding: 20px;
            color: var(--text-secondary);
        }

        /* Detalhes do anime */
        .anime-details-container {
            display: none;
        }

        .anime-header {
            display: flex;
            padding: 30px;
            background-color: var(--header-bg);
            border-radius: 8px 8px 0 0;
        }

        .anime-cover {
            flex-shrink: 0;
            width: 225px;
            height: 320px;
            margin-right: 30px;
            border-radius: 8px;
            overflow: hidden;
            box-shadow: var(--card-shadow);
        }

        .anime-cover img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .anime-header-info {
            flex: 1;
        }

        .anime-header-info h1 {
            font-size: 28px;
            margin-bottom: 15px;
            color: var(--text-primary);
        }

        .anime-meta {
            display: flex;
            flex-wrap: wrap;
            margin-bottom: 15px;
        }

        .anime-meta span {
            margin-right: 15px;
            padding: 5px 10px;
            background-color: var(--anime-meta-bg);
            border-radius: 4px;
            font-size: 14px;
            color: var(--anime-meta-text);
        }

        .anime-genres {
            display: flex;
            flex-wrap: wrap;
            margin-bottom: 20px;
        }

        .anime-genres span {
            margin-right: 10px;
            margin-bottom: 10px;
            padding: 5px 10px;
            background-color: var(--accent-color);
            color: #fff;
            border-radius: 20px;
            font-size: 14px;
        }

        .anime-synopsis {
            font-size: 16px;
            line-height: 1.6;
            color: var(--text-secondary);
            max-height: 150px;
            overflow-y: auto;
        }

        /* Tabs */
        .anime-tabs {
            display: flex;
            background-color: var(--bg-secondary);
            border-bottom: 1px solid var(--border-color);
            overflow-x: auto;
            -webkit-overflow-scrolling: touch;
        }

        .tab-button {
            padding: 15px 20px;
            background-color: transparent;
            border: none;
            border-bottom: 2px solid transparent;
            font-size: 16px;
            color: var(--text-secondary);
            cursor: pointer;
            transition: all 0.3s;
            white-space: nowrap;
        }

        .tab-button:hover {
            color: var(--accent-color);
        }

        .tab-button.active {
            color: var(--tab-active-color);
            border-bottom-color: var(--tab-active-border);
        }

        /* Conteúdo das tabs */
        .tab-content {
            padding: 20px;
        }

        .tab-pane {
            display: none;
        }

        .tab-pane.active {
            display: block;
        }

        /* Lista de episódios */
        .episodes-list {
            margin-bottom: 20px;
        }

        .episode-item {
            display: flex;
            align-items: center;
            padding: 15px;
            border-bottom: 1px solid var(--border-color);
            transition: background-color 0.3s;
            cursor: pointer;
        }

        .episode-item:hover {
            background-color: var(--hover-bg);
        }

        .episode-number {
            width: 50px;
            font-size: 18px;
            font-weight: 500;
            color: var(--accent-color);
        }

        .episode-title {
            flex: 1;
            font-size: 16px;
            color: var(--text-primary);
        }

        .episode-date {
            font-size: 14px;
            color: var(--text-secondary);
        }

        /* Paginação */
        .pagination {
            display: flex;
            justify-content: center;
            margin-top: 20px;
            flex-wrap: wrap;
            gap: 5px;
        }

        .pagination-button {
            padding: 8px 15px;
            margin: 0 5px;
            background-color: var(--bg-secondary);
            border: 1px solid var(--button-secondary-border);
            border-radius: 4px;
            font-size: 14px;
            color: var(--text-secondary);
            cursor: pointer;
            transition: all 0.3s;
        }

        .pagination-button:hover {
            background-color: var(--hover-bg);
        }

        .pagination-button.active {
            background-color: var(--pagination-active-bg);
            color: var(--pagination-active-text);
            border-color: var(--pagination-active-bg);
        }

        .pagination-button.disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        /* Grid de personagens */
        .characters-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
            gap: 20px;
        }

        .character-card {
            background-color: var(--card-bg);
            border-radius: 8px;
            overflow: hidden;
            box-shadow: var(--card-shadow);
            transition: transform 0.3s, box-shadow 0.3s;
        }

        .character-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
        }

        .character-image {
            width: 100%;
            height: 200px;
            object-fit: cover;
        }

        .character-info {
            padding: 10px;
        }

        .character-name {
            font-size: 14px;
            font-weight: 500;
            margin-bottom: 5px;
            color: var(--text-primary);
        }

        .character-role {
            font-size: 12px;
            color: var(--text-secondary);
        }

        .character-voice {
            font-size: 11px;
            color: var(--accent-color);
            margin-top: 5px;
        }

        /* Avaliações */
        .reviews-list {
            margin-bottom: 20px;
        }

        .review-item {
            padding: 20px;
            margin-bottom: 20px;
            background-color: var(--review-bg);
            border-radius: 8px;
        }

        .review-header {
            display: flex;
            justify-content: space-between;
            margin-bottom: 10px;
        }

        .reviewer {
            font-weight: 500;
            color: var(--text-primary);
        }

        .review-score {
            color: var(--accent-color);
            font-weight: 500;
        }

        .review-content {
            font-size: 14px;
            line-height: 1.6;
            color: var(--text-secondary);
        }

        /* Pesquisa */
        .search-results-container {
            display: none;
        }

        .search-header {
            margin-bottom: 30px;
        }

        .search-header h1 {
            font-size: 24px;
            color: var(--text-primary);
        }

        .search-header h1 span {
            color: var(--accent-color);
        }

        .search-results {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .no-results, .error {
            grid-column: 1 / -1;
            text-align: center;
            padding: 40px;
            color: var(--text-secondary);
            background-color: var(--bg-primary);
            border-radius: 8px;
        }

        .error {
            color: #d93025;
        }

        /* Botão de voltar */
        .back-button {
            display: inline-flex;
            align-items: center;
            padding: 8px 16px;
            background-color: var(--bg-primary);
            border: none;
            border-radius: 4px;
            color: var(--text-secondary);
            font-size: 14px;
            cursor: pointer;
            margin-bottom: 20px;
            transition: background-color 0.3s;
        }

        .back-button:hover {
            background-color: var(--hover-bg);
        }

        .back-button i {
            margin-right: 5px;
        }

        /* Modal de Login */
        .overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: var(--modal-overlay);
            z-index: 1000;
            display: none;
        }

        .login-modal {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background-color: var(--modal-bg);
            border-radius: 8px;
            box-shadow: var(--card-shadow);
            width: 400px;
            max-width: 90%;
            z-index: 1001;
            display: none;
        }

        .login-container {
            padding: 30px;
        }

        .login-header {
            text-align: center;
            margin-bottom: 30px;
        }

        .login-logo {
            width: 60px;
            height: 60px;
            margin-bottom: 15px;
            border-radius: 50%;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            margin-bottom: 5px;
            font-size: 14px;
            color: var(--text-secondary);
        }

        .form-group input {
            width: 100%;
            padding: 10px;
            border: 1px solid var(--button-secondary-border);
            border-radius: 4px;
            font-size: 16px;
            background-color: var(--input-bg);
            color: var(--text-primary);
        }

        .form-actions {
            display: flex;
            justify-content: space-between;
            margin-top: 30px;
        }

        #createAccountBtn {
            background-color: transparent;
            border: none;
            color: var(--accent-color);
            font-size: 14px;
            cursor: pointer;
        }

        #loginBtn {
            background-color: var(--button-primary-bg);
            color: var(--button-primary-text);
            border: none;
            border-radius: 4px;
            padding: 10px 20px;
            font-size: 14px;
            cursor: pointer;
        }

        .google-login-btn {
            display: flex;
            align-items: center;
            justify-content: center;
            width: 100%;
            padding: 10px;
            background-color: var(--bg-secondary);
            border: 1px solid var(--button-secondary-border);
            border-radius: 4px;
            font-size: 14px;
            color: var(--text-secondary);
            cursor: pointer;
            margin-bottom: 20px;
        }

        .google-login-btn img {
            width: 18px;
            height: 18px;
            margin-right: 10px;
        }

        /* Páginas específicas */
        .trending-page, .seasons-page, .genres-page, .favorites-page, .settings-page, .help-page {
            display: none;
        }

        /* Galeria de imagens */
        .images-tab {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 20px;
        }

        .image-card {
            background-color: var(--card-bg);
            border-radius: 8px;
            overflow: hidden;
            box-shadow: var(--card-shadow);
            transition: transform 0.3s, box-shadow 0.3s;
            cursor: pointer;
        }

        .image-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
        }

        .anime-gallery-image {
            width: 100%;
            height: 200px;
            object-fit: cover;
        }

        .image-type {
            padding: 10px;
            font-size: 14px;
            color: var(--text-secondary);
            text-align: center;
        }

        /* Filtros de gênero */
        .genre-filters {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-bottom: 20px;
        }

        .genre-filter {
            padding: 8px 16px;
            background-color: var(--genre-bg);
            border: 1px solid var(--button-secondary-border);
            border-radius: 20px;
            font-size: 14px;
            color: var(--text-secondary);
            cursor: pointer;
            transition: all 0.3s;
        }

        .genre-filter:hover {
            background-color: var(--hover-bg);
        }

        .genre-filter.active {
            background-color: var(--genre-active-bg);
            color: var(--genre-active-text);
            border-color: var(--genre-active-bg);
        }

        /* Seletor de temporada */
        .season-selector {
            display: flex;
            justify-content: space-between;
            margin-bottom: 30px;
            flex-wrap: wrap;
            gap: 10px;
        }

        .season-year, .season-name {
            padding: 10px 20px;
            background-color: var(--bg-secondary);
            border: 1px solid var(--button-secondary-border);
            border-radius: 4px;
            font-size: 16px;
            color: var(--text-secondary);
            flex-grow: 1;
        }

        /* Configurações */
        .settings-section {
            margin-bottom: 30px;
        }

        .settings-section h3 {
            margin-bottom: 15px;
            color: var(--text-primary);
        }

        .settings-option {
            display: flex;
            align-items: center;
            margin-bottom: 15px;
        }

        .settings-option label {
            margin-left: 10px;
            font-size: 16px;
            color: var(--text-secondary);
        }

        /* Ajuda */
        .help-section {
            margin-bottom: 30px;
        }

        .help-section h3 {
            margin-bottom: 15px;
            color: var(--text-primary);
        }

        .faq-item {
            margin-bottom: 20px;
        }

        .faq-question {
            font-size: 16px;
            font-weight: 500;
            color: var(--text-primary);
            margin-bottom: 10px;
        }

        .faq-answer {
            font-size: 14px;
            line-height: 1.6;
            color: var(--text-secondary);
        }

        /* Favoritos */
        .favorites-empty {
            text-align: center;
            padding: 40px;
            color: var(--text-secondary);
            background-color: var(--bg-primary);
            border-radius: 8px;
        }

        .favorite-button {
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 8px 16px;
            background-color: var(--bg-primary);
            border: none;
            border-radius: 4px;
            color: var(--text-secondary);
            font-size: 14px;
            cursor: pointer;
            margin-top: 20px;
            transition: all 0.3s;
        }

        .favorite-button:hover {
            background-color: var(--hover-bg);
        }

        .favorite-button i {
            margin-right: 5px;
            color: var(--favorite-icon-color);
        }

        .favorite-button.active i {
            color: var(--favorite-icon-color);
        }

        /* Responsividade */
        @media (max-width: 1024px) {
            .search-bar {
                width: 300px;
            }
        }

        @media (max-width: 768px) {
            .menu-toggle {
                display: block;
            }
            
            .sidebar {
                width: 250px;
                transform: translateX(-100%);
            }
            
            .sidebar.active {
                transform: translateX(0);
            }
            
            .main-content {
                margin-left: 0;
                padding: 15px;
            }
            
            .search-bar {
                width: 200px;
            }
            
            .anime-grid, .episodes-grid, .search-results, .images-tab {
                grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
            }

            .anime-header {
                flex-direction: column;
                padding: 20px;
            }
            
            .anime-cover {
                width: 100%;
                max-width: 225px;
                height: auto;
                margin: 0 auto 20px;
            }
            
            .anime-tabs {
                overflow-x: auto;
                white-space: nowrap;
                padding-bottom: 5px;
            }
            
            .tab-button {
                padding: 12px 15px;
                font-size: 14px;
            }
            
            .characters-grid {
                grid-template-columns: repeat(auto-fill, minmax(120px, 1fr));
            }
            
            .header {
                flex-wrap: wrap;
                gap: 10px;
            }
            
            .header-right {
                margin-left: auto;
            }
            
            .profile-popup {
                right: 10px;
                width: 300px;
            }
        }

        @media (max-width: 480px) {
            .anime-grid, .episodes-grid, .search-results, .images-tab, .characters-grid {
                grid-template-columns: repeat(auto-fill, minmax(130px, 1fr));
                gap: 15px;
            }
            
            .anime-image {
                height: 200px;
            }
            
            .search-bar {
                width: 100%;
                margin-top: 10px;
                order: 3;
            }
            
            .header {
                flex-direction: row;
                justify-content: space-between;
                align-items: center;
            }
            
            .header-left {
                display: flex;
                align-items: center;
            }
            
            .episode-item {
                flex-direction: column;
            }
            
            .episode-date {
                margin-top: 5px;
            }
            
            .anime-meta, .anime-genres {
                flex-wrap: wrap;
                gap: 5px;
            }
            
            .anime-meta span, .anime-genres span {
                margin-bottom: 5px;
            }
            
            .anime-info-grid {
                grid-template-columns: 1fr;
            }
            
            .anime-info-item {
                flex-direction: column;
                align-items: flex-start;
            }
            
            .anime-info-label {
                width: 100%;
                margin-bottom: 5px;
            }
            
            .form-actions {
                flex-direction: column;
                gap: 10px;
            }
            
            #createAccountBtn, #loginBtn {
                width: 100%;
                text-align: center;
            }
        }

        /* Imagem ampliada */
        .image-modal {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: var(--image-modal-bg);
            z-index: 2000;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        .modal-image {
            max-width: 90%;
            max-height: 90%;
            object-fit: contain;
        }

        .close-image-modal {
            position: absolute;
            top: 20px;
            right: 20px;
            color: #fff;
            font-size: 30px;
            cursor: pointer;
        }

        /* Novos estilos para edição de perfil */
        .edit-profile-modal {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background-color: var(--modal-bg);
            border-radius: 8px;
            box-shadow: var(--card-shadow);
            width: 400px;
            max-width: 90%;
            z-index: 1001;
            display: none;
        }

        .edit-profile-container {
            padding: 30px;
        }

        .edit-profile-header {
            text-align: center;
            margin-bottom: 30px;
        }

        .edit-profile-avatar {
            position: relative;
            width: 100px;
            height: 100px;
            margin: 0 auto 20px;
        }

        .edit-profile-avatar img {
            width: 100%;
            height: 100%;
            border-radius: 50%;
            object-fit: cover;
        }

        .change-avatar {
            position: absolute;
            bottom: 0;
            right: 0;
            background-color: var(--bg-secondary);
            border-radius: 50%;
            padding: 8px;
            box-shadow: var(--card-shadow);
            cursor: pointer;
        }

        .avatar-input {
            display: none;
        }

        .save-profile-btn {
            background-color: var(--button-primary-bg);
            color: var(--button-primary-text);
            border: none;
            border-radius: 4px;
            padding: 10px 20px;
            font-size: 14px;
            cursor: pointer;
            width: 100%;
            margin-top: 20px;
        }

        /* Botão salvar nas configurações */
        .save-settings-btn {
            background-color: var(--button-primary-bg);
            color: var(--button-primary-text);
            border: none;
            border-radius: 4px;
            padding: 10px 20px;
            font-size: 14px;
            cursor: pointer;
            margin-top: 20px;
        }

        /* Informações detalhadas do anime */
        .anime-detailed-info {
            margin-top: 20px;
            border-top: 1px solid var(--border-color);
            padding-top: 20px;
        }

        .anime-info-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
        }

        .anime-info-item {
            display: flex;
            margin-bottom: 10px;
        }

        .anime-info-label {
            font-weight: 500;
            width: 150px;
            color: var(--text-secondary);
        }

        .anime-info-value {
            flex: 1;
            color: var(--text-primary);
        }

        /* Trailers */
        .trailers-container {
            margin-top: 20px;
        }

        .trailer-item {
            margin-bottom: 20px;
        }

        .trailer-video {
            width: 100%;
            border-radius: 8px;
            overflow: hidden;
        }

        /* Plataformas de streaming */
        .streaming-platforms {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-top: 10px;
        }

        .platform-item {
            padding: 5px 10px;
            background-color: var(--platform-bg);
            border-radius: 4px;
            font-size: 14px;
            color: var(--platform-text);
        }

        /* Modal para adicionar nova conta */
        .add-account-modal {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background-color: var(--modal-bg);
            border-radius: 8px;
            box-shadow: var(--card-shadow);
            width: 400px;
            max-width: 90%;
            z-index: 1001;
            display: none;
        }

        .add-account-container {
            padding: 30px;
        }

        .add-account-header {
            text-align: center;
            margin-bottom: 30px;
        }

        /* Efeito de carregamento do Blogger */
        .blogger-loading {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 3px;
            background-color: var(--loading-bg);
            z-index: 2000;
        }

        .blogger-loading-bar {
            height: 100%;
            width: 0;
            background-color: var(--loading-bar);
            transition: width 0.3s ease-in-out;
        }

        /* Efeito de pesquisa do Blogger */
        .search-suggestions {
            position: absolute;
            top: 100%;
            left: 0;
            right: 0;
            background-color: var(--bg-secondary);
            border-radius: 0 0 8px 8px;
            box-shadow: var(--card-shadow);
            z-index: 100;
            display: none;
            max-height: 300px;
            overflow-y: auto;
        }

        .suggestion-item {
            padding: 10px 15px;
            cursor: pointer;
            transition: background-color 0.2s;
            color: var(--text-primary);
        }

        .suggestion-item:hover {
            background-color: var(--hover-bg);
        }

        .search-highlight {
            color: var(--accent-color);
            font-weight: 500;
        }

        /* Add styles for video player */
        .video-player-container {
            display: none;
            margin-bottom: 20px;
            width: 100%;
            border-radius: 8px;
            overflow: hidden;
            box-shadow: var(--card-shadow);
        }
        
        .video-player {
            width: 100%;
            aspect-ratio: 16/9;
            background-color: #000;
        }
        
        .video-title {
            padding: 15px;
            background-color: var(--bg-secondary);
            color: var(--text-primary);
            font-weight: 500;
            border-bottom: 1px solid var(--border-color);
        }
        
        .episode-item.active {
            background-color: var(--hover-bg);
            border-left: 3px solid var(--accent-color);
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Sidebar similar ao Blogger -->
        <div class="sidebar" id="sidebar">
            <div class="logo">
                <img src="https://hebbkx1anhila5yf.public.blob.vercel-storage.com/Captura%20de%20tela%202025-03-24%20213027-TNmCDRAGaD4bMH7QEX5mc4craQCPnw.png" alt="AnimeBlog Logo" id="logo">
                <span>AnimeBlog</span>
            </div>
            <div class="menu">
                <a class="menu-item active" data-section="home">
                    <i class="material-icons">home</i>
                    <span>Início</span>
                </a>
                <a class="menu-item" data-section="trending">
                    <i class="material-icons">trending_up</i>
                    <span>Em Alta</span>
                </a>
                <a class="menu-item" data-section="seasons">
                    <i class="material-icons">date_range</i>
                    <span>Temporadas</span>
                </a>
                <a class="menu-item" data-section="genres">
                    <i class="material-icons">category</i>
                    <span>Gêneros</span>
                </a>
                <a class="menu-item" data-section="favorites">
                    <i class="material-icons">favorite</i>
                    <span>Favoritos</span>
                </a>
                <div class="divider"></div>
                <a class="menu-item" data-section="settings">
                    <i class="material-icons">settings</i>
                    <span>Configurações</span>
                </a>
                <a class="menu-item" data-section="help">
                    <i class="material-icons">help</i>
                    <span>Ajuda</span>
                </a>
            </div>
            <div class="footer">
                <a href="#" id="termsLink">Termos de Serviço</a> · 
                <a href="#" id="privacyLink">Privacidade</a> ·
                <a href="#" id="contentPolicyLink">Política de conteúdo</a>
            </div>
        </div>

        <!-- Conteúdo principal -->
        <div class="main-content">
            <!-- Efeito de carregamento do Blogger -->
            <div class="blogger-loading" id="bloggerLoading">
                <div class="blogger-loading-bar" id="bloggerLoadingBar"></div>
            </div>

            <div class="header">
                <div class="header-left">
                    <button class="menu-toggle" id="menuToggle">
                        <i class="material-icons">menu</i>
                    </button>
                </div>
                <div class="search-bar">
                    <i class="material-icons">search</i>
                    <input type="text" placeholder="Pesquisar animes..." id="searchInput">
                    <div class="search-suggestions" id="searchSuggestions"></div>
                </div>
   
);

                <div class="header-right">
                    <!-- Botão de alternância de tema -->
                    <div class="theme-toggle-header" id="themeToggle">
                        <svg class="sun-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                            <path d="M12 17c-2.76 0-5-2.24-5-5s2.24-5 5-5 5 2.24 5 5-2.24 5-5 5zm0-8c-1.65 0-3 1.35-3 3s1.35 3 3 3 3-1.35 3-3-1.35-3-3-3zm0-3c.55 0 1-.45 1-1V3c0-.55-.45-1-1-1s-1 .45-1 1v2c0 .55.45 1 1 1zm0 14c-.55 0-1 .45-1 1v2c0 .55.45 1 1 1s1-.45 1-1v-2c0-.55-.45-1-1-1zm7-7c0-.55-.45-1-1-1h-2c-.55 0-1 .45-1 1s.45 1 1 1h2c.55 0 1-.45 1-1zm-14 0c0 .55.45 1 1 1h2c.55 0 1-.45 1-1s-.45-1-1-1H6c-.55 0-1 .45-1 1zm12.95 4.55c-.39-.39-1.02-.39-1.41 0-.39.39-.39 1.02 0 1.41l1.41 1.41c.39.39 1.02.39 1.41 0 .39-.39.39-1.02 0-1.41l-1.41-1.41zm-9.9-9.9l-1.41-1.41c-.39-.39-1.02-.39-1.41 0-.39.39-.39 1.02 0 1.41L5.64 7.05c.39.39 1.02.39 1.41 0 .39-.39.39-1.02 0-1.41zm9.9 0c-.39-.39-1.02-.39-1.41 0L16.95 7.05c-.39.39-.39 1.02 0 1.41.39.39 1.02.39 1.41 0l1.41-1.41c.39-.39.39-1.02 0-1.41zM5.64 16.95l-1.41 1.41c-.39.39-.39 1.02 0 1.41.39.39 1.02.39 1.41 0l1.41-1.41c.39-.39.39-1.02 0-1.41-.39-.39-1.02-.39-1.41 0z"/>
                        </svg>
                        <svg class="moon-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                            <path d="M12 3c-4.97 0-9 4.03-9 9s4.03 9 9 9 9-4.03 9-9c0-.46-.04-.92-.1-1.36-.98 1.37-2.58 2.26-4.4 2.26-2.98 0-5.4-2.42-5.4-5.4 0-1.81.89-3.42 2.26-4.4-.44-.06-.9-.1-1.36-.1z"/>
                        </svg>
                    </div>
                    <div class="user-profile" id="userProfileBtn">
                        <div class="avatar">
                            <img src="https://hebbkx1anhila5yf.public.blob.vercel-storage.com/Captura%20de%20tela%202025-03-24%20213027-TNmCDRAGaD4bMH7QEX5mc4craQCPnw.png" alt="Avatar" id="userAvatar">
                        </div>
                    </div>
                </div>
            </div>

            <!-- Popup de perfil (inicialmente oculto) -->
            <div class="profile-popup" id="profilePopup">
                <div class="popup-header">
                    <span id="userEmail"><a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="ff8a8c8a9e8d9690bf98929e9693d19c9092">[email&#160;protected]</a></span>
                    <i class="material-icons close-popup" id="closePopup">close</i>
                </div>
                <div class="popup-content">
                    <div class="avatar-large">
                        <img src="https://hebbkx1anhila5yf.public.blob.vercel-storage.com/Captura%20de%20tela%202025-03-24%20213027-TNmCDRAGaD4bMH7QEX5mc4craQCPnw.png" alt="Avatar" id="popupAvatar">
                        <div class="edit-icon" id="editProfileBtn">
                            <i class="material-icons">edit</i>
                        </div>
                    </div>
                    <p class="greeting">Olá, <span id="userName">usuário</span>!</p>
                    <button class="manage-account">Gerenciar sua Conta do AnimeBlog</button>
                    <div class="account-actions">
                        <button class="add-account" id="addAccountBtn">
                            <i class="material-icons">add</i>
                            Adicionar conta
                        </button>
                        <button class="logout" id="logoutBtn">
                            <i class="material-icons">logout</i>
                            Sair
                        </button>
                    </div>
                    <div class="popup-footer">
                        <a href="#" id="popupPrivacyLink">Política de Privacidade</a> · 
                        <a href="#" id="popupTermsLink">Termos de Serviço</a>
                    </div>
                </div>
            </div>

            <!-- Página inicial -->
            <div id="homePage">
                <!-- Animes em destaque -->
                <div class="content">
                    <h1>Animes em Destaque</h1>
                    <div class="anime-grid" id="featuredAnimes">
                        <div class="loading">Carregando animes em destaque...</div>
                    </div>
                </div>

                <!-- Últimos episódios -->
                <div class="content">
                    <h2>Últimos Episódios</h2>
                    <div class="episodes-grid" id="latestEpisodes">
                        <div class="loading">Carregando últimos episódios...</div>
                    </div>
                </div>

                <!-- Animes da temporada -->
                <div class="content">
                    <h2>Temporada Atual</h2>
                    <div class="anime-grid" id="seasonAnimes">
                        <div class="loading">Carregando animes da temporada...</div>
                    </div>
                </div>
            </div>

            <!-- Página Em Alta -->
            <div id="trendingPage" class="trending-page">
                <div class="content">
                    <h1>Animes Em Alta</h1>
                    <div class="anime-grid" id="trendingAnimes">
                        <div class="loading">Carregando animes em alta...</div>
                    </div>
                    <div class="pagination" id="trendingPagination"></div>
                </div>
            </div>

            <!-- Página Temporadas -->
            <div id="seasonsPage" class="seasons-page">
                <div class="content">
                    <h1>Animes por Temporada</h1>
                    <div class="season-selector">
                        <select class="season-year" id="seasonYear">
                            <!-- Será preenchido via JavaScript -->
                        </select>
                        <select class="season-name" id="seasonName">
                            <option value="winter">Inverno</option>
                            <option value="spring">Primavera</option>
                            <option value="summer">Verão</option>
                            <option value="fall">Outono</option>
                        </select>
                    </div>
                    <div class="anime-grid" id="seasonalAnimes">
                        <div class="loading">Carregando animes da temporada...</div>
                    </div>
                    <div class="pagination" id="seasonalPagination"></div>
                </div>
            </div>

            <!-- Página Gêneros -->
            <div id="genresPage" class="genres-page">
                <div class="content">
                    <h1>Animes por Gênero</h1>
                    <div class="genre-filters" id="genreFilters">
                        <!-- Será preenchido via JavaScript -->
                    </div>
                    <div class="anime-grid" id="genreAnimes">
                        <div class="loading">Selecione um gênero para ver os animes...</div>
                    </div>
                    <div class="pagination" id="genrePagination"></div>
                </div>
            </div>

            <!-- Página Favoritos -->
            <div id="favoritesPage" class="favorites-page">
                <div class="content">
                    <h1>Seus Animes Favoritos</h1>
                    <div class="anime-grid" id="favoriteAnimes">
                        <div class="favorites-empty">Você ainda não adicionou nenhum anime aos favoritos.</div>
                    </div>
                </div>
            </div>

            <!-- Página Configurações -->
            <div id="settingsPage" class="settings-page">
                <div class="content">
                    <h1>Configurações</h1>
                    
                    <div class="settings-section">
                        <h3>Idioma</h3>
                        <div class="settings-option">
                            <input type="radio" name="language" id="langPt" checked>
                            <label for="langPt">Português</label>
                        </div>
                        <div class="settings-option">
                            <input type="radio" name="language" id="langEn">
                            <label for="langEn">English</label>
                        </div>
                    </div>
                    
                    <div class="settings-section">
                        <h3>Notificações</h3>
                        <div class="settings-option">
                            <input type="checkbox" id="notifyNewEpisodes" checked>
                            <label for="notifyNewEpisodes">Novos episódios</label>
                        </div>
                        <div class="settings-option">
                            <input type="checkbox" id="notifyNewAnimes" checked>
                            <label for="notifyNewAnimes">Novos animes</label>
                        </div>
                    </div>

                    <button class="save-settings-btn" id="saveSettingsBtn">Salvar</button>
                </div>
            </div>

            <!-- Página Ajuda -->
            <div id="helpPage" class="help-page">
                <div class="content">
                    <h1>Ajuda</h1>
                    
                    <div class="help-section">
                        <h3>Perguntas Frequentes</h3>
                        
                        <div class="faq-item">
                            <div class="faq-question">Como adicionar um anime aos favoritos?</div>
                            <div class="faq-answer">Para adicionar um anime aos favoritos, acesse a página de detalhes do anime e clique no botão "Adicionar aos Favoritos" com o ícone de coração.</div>
                        </div>
                        
                        <div class="faq-item">
                            <div class="faq-question">Como pesquisar animes?</div>
                            <div class="faq-answer">Use a barra de pesquisa no topo da página para buscar animes por nome. Digite o termo de pesquisa e pressione Enter.</div>
                        </div>
                        
                        <div class="faq-item">
                            <div class="faq-question">Como filtrar animes por gênero?</div>
                            <div class="faq-answer">Acesse a seção "Gêneros" no menu lateral e selecione o gênero desejado para ver os animes correspondentes.</div>
                        </div>
                        
                        <div class="faq-item">
                            <div class="faq-question">Como criar uma conta?</div>
                            <div class="faq-answer">Clique no botão "Criar conta" na tela de login e preencha os campos solicitados, ou use a opção "Entrar com Google".</div>
                        </div>
                        
                        <div class="faq-item">
                            <div class="faq-question">Como alternar entre os temas claro e escuro?</div>
                            <div class="faq-answer">Clique no ícone de sol/lua ao lado da sua foto de perfil no canto superior direito para alternar entre os temas claro e escuro.</div>
                        </div>
                    </div>
                    
                    <div class="help-section">
                        <h3>Contato</h3>
                        <p>Se você tiver alguma dúvida ou problema, entre em contato conosco pelo email: <a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="4d3e383d223f39280d2c232420282f21222a632e2220">[email&#160;protected]</a></p>
                    </div>
                </div>
            </div>

            <!-- Detalhes do anime -->
            <div id="animeDetailsPage" class="anime-details-container">
                <button class="back-button" id="backToHome">
                    <i class="material-icons">arrow_back</i>
                    Voltar
                </button>
                
                <div class="content">
                    <div class="loading-anime">Carregando detalhes do anime...</div>
                    
                    <div class="anime-header" id="animeHeader" style="display: none;">
                        <div class="anime-cover">
                            <img src="/placeholder.svg" alt="" id="animeCover">
                        </div>
                        <div class="anime-header-info">
                            <h1 id="animeTitle"></h1>
                            <div class="anime-meta">
                                <span id="animeType"></span>
                                <span id="animeYear"></span>
                                <span id="animeStatus"></span>
                                <span id="animeScore"></span>
                            </div>
                            <div class="anime-genres" id="animeGenres"></div>
                            <p class="anime-synopsis" id="animeSynopsis"></p>
                            <button class="favorite-button" id="favoriteButton">
                                <i class="material-icons">favorite_border</i>
                                Adicionar aos Favoritos
                            </button>

                            <!-- Informações detalhadas do anime -->
                            <div class="anime-detailed-info">
                                <div class="anime-info-grid">
                                    <div class="anime-info-item">
                                        <div class="anime-info-label">Títulos Alternativos:</div>
                                        <div class="anime-info-value" id="animeTitlesAlt"></div>
                                    </div>
                                    <div class="anime-info-item">
                                        <div class="anime-info-label">Exibido:</div>
                                        <div class="anime-info-value" id="animeAired"></div>
                                    </div>
                                    <div class="anime-info-item">
                                        <div class="anime-info-label">Status:</div>
                                        <div class="anime-info-value" id="animeStatusDetailed"></div>
                                    </div>
                                    <div class="anime-info-item">
                                        <div class="anime-info-label">Transmissão:</div>
                                        <div class="anime-info-value" id="animeBroadcast"></div>
                                    </div>
                                    <div class="anime-info-item">
                                        <div class="anime-info-label">Estreou:</div>
                                        <div class="anime-info-value" id="animePremiered"></div>
                                    </div>
                                    <div class="anime-info-item">
                                        <div class="anime-info-label">Temas:</div>
                                        <div class="anime-info-value" id="animeThemes"></div>
                                    </div>
                                    <div class="anime-info-item">
                                        <div class="anime-info-label">Duração por episódio:</div>
                                        <div class="anime-info-value" id="animeDuration"></div>
                                    </div>
                                    <div class="anime-info-item">
                                        <div class="anime-info-label">Classificação:</div>
                                        <div class="anime-info-value" id="animeRating"></div>
                                    </div>
                                    <div class="anime-info-item">
                                        <div class="anime-info-label">Pontuação:</div>
                                        <div class="anime-info-value" id="animeScoreDetailed"></div>
                                    </div>
                                    <div class="anime-info-item">
                                        <div class="anime-info-label">Popularidade:</div>
                                        <div class="anime-info-value" id="animePopularity"></div>
                                    </div>
                                    <div class="anime-info-item">
                                        <div class="anime-info-label">Membros:</div>
                                        <div class="anime-info-value" id="animeMembers"></div>
                                    </div>
                                    <div class="anime-info-item">
                                        <div class="anime-info-label">Favoritos:</div>
                                        <div class="anime-info-value" id="animeFavorites"></div>
                                    </div>
                                    <div class="anime-info-item">
                                        <div class="anime-info-label">Produtores:</div>
                                        <div class="anime-info-value" id="animeProducers"></div>
                                    </div>
                                    <div class="anime-info-item">
                                        <div class="anime-info-label">Plataformas de streaming:</div>
                                        <div class="anime-info-value">
                                            <div class="streaming-platforms" id="animeStreaming"></div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="anime-tabs">
                        <button class="tab-button active" data-tab="episodes">Episódios</button>
                        <button class="tab-button" data-tab="characters">Personagens</button>
                        <button class="tab-button" data-tab="images">Imagens</button>
                        <button class="tab-button" data-tab="related">Relacionados</button>
                        <button class="tab-button" data-tab="reviews">Avaliações</button>
                        <button class="tab-button" data-tab="trailers">Trailers</button>
                    </div>
                    
                    <div class="tab-content">
                        <div class="tab-pane active" id="episodesTab">
                            <div class="episodes-list" id="episodesList">
                                <div class="loading">Carregando episódios...</div>
                            </div>
                            <div class="pagination" id="episodesPagination"></div>
                        </div>
                        
                        <div class="tab-pane" id="charactersTab">
                            <div class="characters-grid" id="charactersGrid">
                                <div class="loading">Carregando personagens...</div>
                            </div>
                        </div>
                        
                        <div class="tab-pane" id="imagesTab">
                            <div class="images-tab" id="imagesGrid">
                                <div class="loading">Carregando imagens...</div>
                            </div>
                        </div>
                        
                        <div class="tab-pane" id="relatedTab">
                            <div class="anime-grid" id="relatedAnime">
                                <div class="loading">Carregando animes relacionados...</div>
                            </div>
                        </div>
                        
                        <div class="tab-pane" id="reviewsTab">
                            <div class="reviews-list" id="reviewsList">
                                <div class="loading">Carregando avaliações...</div>
                            </div>
                        </div>

                        <div class="tab-pane" id="trailersTab">
                            <div class="trailers-container" id="trailersContainer">
                                <div class="loading">Carregando trailers...</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Resultados da pesquisa -->
            <div id="searchResultsPage" class="search-results-container">
                <button class="back-button" id="backFromSearch">
                    <i class="material-icons">arrow_back</i>
                    Voltar
                </button>
                
                <div class="content">
                    <div class="search-header">
                        <h1>Resultados para: <span id="searchTerm"></span></h1>
                    </div>
                    
                    <div class="search-results" id="searchResults">
                        <div class="loading">Carregando resultados...</div>
                    </div>
                    
                    <div class="pagination" id="searchPagination"></div>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal de Login (inicialmente oculto) -->
    <div class="login-modal" id="loginModal">
        <div class="login-container">
            <div class="login-header">
                <img src="https://hebbkx1anhila5yf.public.blob.vercel-storage.com/Captura%20de%20tela%202025-03-24%20213027-TNmCDRAGaD4bMH7QEX5mc4craQCPnw.png" alt="AnimeBlog Logo" class="login-logo">
                <h2>Entrar no AnimeBlog</h2>
            </div>
            <button class="google-login-btn" id="googleLoginBtn">
                <img src="https://upload.wikimedia.org/wikipedia/commons/5/53/Google_%22G%22_Logo.svg" alt="Google">
                Entrar com Google
            </button>
            <form id="loginForm">
                <div class="form-group">
                    <label for="email">Email</label>
                    <input type="email" id="email" required>
                </div>
                <div class="form-group">
                    <label for="password">Senha</label>
                    <input type="password" id="password" required>
                </div>
                <div class="form-actions">
                    <button type="button" id="createAccountBtn">Criar conta</button>
                    <button type="submit" id="loginBtn">Entrar</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Modal de Edição de Perfil -->
    <div class="edit-profile-modal" id="editProfileModal">
        <div class="edit-profile-container">
            <div class="edit-profile-header">
                <h2>Editar Perfil</h2>
            </div>
            <div class="edit-profile-avatar">
                <img src="https://hebbkx1anhila5yf.public.blob.vercel-storage.com/Captura%20de%20tela%202025-03-24%20213027-TNmCDRAGaD4bMH7QEX5mc4craQCPnw.png" alt="Avatar" id="editAvatarPreview">
                <div class="change-avatar" id="changeAvatarBtn">
                    <i class="material-icons">photo_camera</i>
                </div>
                <input type="file" id="avatarInput" class="avatar-input" accept="image/*">
            </div>
            <div class="form-group">
                <label for="profileName">Nome</label>
                <input type="text" id="profileName">
            </div>
            <div class="form-group">
                <label for="profileEmail">Email</label>
                <input type="email" id="profileEmail" disabled>
            </div>
            <button class="save-profile-btn" id="saveProfileBtn">Salvar</button>
        </div>
    </div>

    <!-- Modal para adicionar nova conta -->
    <div class="add-account-modal" id="addAccountModal">
        <div class="add-account-container">
            <div class="add-account-header">
                <h2>Adicionar Nova Conta</h2>
            </div>
            <form id="addAccountForm">
                <div class="form-group">
                    <label for="newEmail">Email</label>
                    <input type="email" id="newEmail" required>
                </div>
                <div class="form-group">
                    <label for="newPassword">Senha</label>
                    <input type="password" id="newPassword" required>
                </div>
                <div class="form-group">
                    <label for="newName">Nome (opcional)</label>
                    <input type="text" id="newName">
                </div>
                <div class="form-actions">
                    <button type="button" id="cancelAddAccountBtn">Cancelar</button>
                    <button type="submit" id="addNewAccountBtn">Adicionar</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Overlay para o modal -->
    <div class="overlay" id="overlay"></div>

    <!-- Modal para imagem ampliada -->
    <div class="image-modal" id="imageModal">
        <span class="close-image-modal" id="closeImageModal">&times;</span>
        <img src="/placeholder.svg" alt="Imagem ampliada" class="modal-image" id="modalImage">
    </div>

    <!-- Modais para políticas -->
    <div class="login-modal" id="termsModal">
        <div class="login-container">
            <div class="login-header">
                <h2>Termos de Serviço</h2>
            </div>
            <div style="max-height: 400px; overflow-y: auto; margin-bottom: 20px;">
                <p>Estes Termos de Serviço ("Termos") regem seu acesso e uso do AnimeBlog. Ao acessar ou usar nosso serviço, você concorda com estes Termos.</p>
                <h3>1. Uso do Serviço</h3>
                <p>O AnimeBlog fornece uma plataforma para descobrir e acompanhar animes. Você concorda em usar o serviço apenas para fins legais e de acordo com estes Termos.</p>
                
                <h3>2. Contas</h3>
                <p>Para acessar alguns recursos do nosso serviço, você pode precisar criar uma conta. Você é responsável por manter a confidencialidade de sua senha e por todas as atividades que ocorrem em sua conta.</p>
                
                <h3>3. Conteúdo</h3>
                <p>Nosso serviço permite que você acesse informações sobre animes. Todo o conteúdo é fornecido apenas para fins informativos e de entretenimento.</p>
                
                <h3>4. Propriedade Intelectual</h3>
                <p>O serviço e seu conteúdo original são propriedade do AnimeBlog e estão protegidos por direitos autorais, marcas registradas e outras leis.</p>
                
                <h3>5. Alterações nos Termos</h3>
                <p>Reservamo-nos o direito de modificar ou substituir estes Termos a qualquer momento. É sua responsabilidade verificar periodicamente os Termos para alterações.</p>
            </div>
            <button class="save-profile-btn" id="closeTermsBtn">Fechar</button>
        </div>
    </div>

    <div class="login-modal" id="privacyModal">
        <div class="login-container">
            <div class="login-header">
                <h2>Política de Privacidade</h2>
            </div>
            <div style="max-height: 400px; overflow-y: auto; margin-bottom: 20px;">
                <p>Esta Política de Privacidade descreve como suas informações pessoais são coletadas, usadas e compartilhadas quando você visita o AnimeBlog.</p>
                
                <h3>1. Informações Coletadas</h3>
                <p>Quando você cria uma conta, coletamos informações como seu nome, endereço de e-mail e senha. Também coletamos informações sobre suas preferências de animes e interações com o site.</p>
                
                <h3>2. Uso de Informações</h3>
                <p>Usamos as informações que coletamos para fornecer, manter e melhorar nosso serviço, personalizar sua experiência e comunicar-nos com você.</p>
                
                <h3>3. Compartilhamento de Informações</h3>
                <p>Não compartilhamos suas informações pessoais com terceiros, exceto conforme necessário para fornecer nosso serviço ou quando exigido por lei.</p>
                
                <h3>4. Segurança</h3>
                <p>Tomamos medidas razoáveis para proteger suas informações pessoais contra acesso não autorizado ou divulgação.</p>
                
                <h3>5. Alterações</h3>
                <p>Podemos atualizar esta política de privacidade periodicamente para refletir mudanças em nossas práticas ou por outros motivos operacionais, legais ou regulatórios.</p>
            </div>
            <button class="save-profile-btn" id="closePrivacyBtn">Fechar</button>
        </div>
    </div>

    <div class="login-modal" id="contentPolicyModal">
        <div class="login-container">
            <div class="login-header">
                <h2>Política de Conteúdo</h2>
            </div>
            <div style="max-height: 400px; overflow-y: auto; margin-bottom: 20px;">
                <p>Esta Política de Conteúdo estabelece diretrizes para o tipo de conteúdo permitido no AnimeBlog.</p>
                
                <h3>1. Conteúdo Proibido</h3>
                <p>Não é permitido conteúdo que seja ilegal, ofensivo, difamatório, obsceno, ameaçador, pornográfico ou que viole direitos de propriedade intelectual.</p>
                
                <h3>2. Precisão das Informações</h3>
                <p>Nos esforçamos para fornecer informações precisas sobre animes, mas não garantimos a exatidão, integridade ou atualidade de todas as informações.</p>
                
                <h3>3. Conteúdo de Terceiros</h3>
                <p>Nosso serviço pode conter links para sites de terceiros que não são de propriedade ou controlados por nós. Não temos controle e não assumimos responsabilidade pelo conteúdo, políticas de privacidade ou práticas de sites de terceiros.</p>
                
                <h3>4. Classificação Etária</h3>
                <p>Fornecemos informações sobre a classificação etária dos animes para ajudar os usuários a fazer escolhas informadas sobre o conteúdo que desejam acessar.</p>
                
                <h3>5. Denúncias</h3>
                <p>Se você encontrar conteúdo que viole esta política, por favor, entre em contato conosco para que possamos tomar as medidas apropriadas.</p>
            </div>
            <button class="save-profile-btn" id="closeContentPolicyBtn">Fechar</button>
        </div>
    </div>

    <!-- JavaScript para funcionalidade responsiva -->
    <script data-cfasync="false" src="/cdn-cgi/scripts/5c5dd728/cloudflare-static/email-decode.min.js"></script>
    <script>
        // Função para alternar o menu lateral em dispositivos móveis
        document.addEventListener('DOMContentLoaded', function() {
            const menuToggle = document.getElementById('menuToggle');
            const sidebar = document.getElementById('sidebar');
            const overlay = document.getElementById('overlay');
            
            // Alternar menu lateral
            menuToggle.addEventListener('click', function() {
                sidebar.classList.toggle('active');
                if (sidebar.classList.contains('active')) {
                    overlay.style.display = 'block';
                } else {
                    overlay.style.display = 'none';
                }
            });
            
            // Fechar menu ao clicar no overlay
            overlay.addEventListener('click', function() {
                sidebar.classList.remove('active');
                overlay.style.display = 'none';
            });
            
            // Alternar tema claro/escuro
            const themeToggle = document.getElementById('themeToggle');
            themeToggle.addEventListener('click', function() {
                document.documentElement.classList.toggle('dark-theme');
            });
            
            // Fechar menu ao selecionar um item em dispositivos móveis
            const menuItems = document.querySelectorAll('.menu-item');
            menuItems.forEach(item => {
                item.addEventListener('click', function() {
                    if (window.innerWidth <= 768) {
                        sidebar.classList.remove('active');
                        overlay.style.display = 'none';
                    }
                });
            });
            
            // Ajustar layout em caso de redimensionamento da janela
            window.addEventListener('resize', function() {
                if (window.innerWidth > 768) {
                    sidebar.classList.remove('active');
                    overlay.style.display = 'none';
                }
            });
        });
    </script>


    <!-- JavaScript para funcionalidade do tema -->
    <script>
        // Função para definir o tema
        function setTheme(isDark) {
            if (isDark) {
                document.documentElement.classList.add('dark-theme');
                document.documentElement.classList.remove('light-theme');
                localStorage.setItem('theme', 'dark');
            } else {
                document.documentElement.classList.add('light-theme');
                document.documentElement.classList.remove('dark-theme');
                localStorage.setItem('theme', 'light');
            }
        }

        // Verificar preferência salva no localStorage
        document.addEventListener('DOMContentLoaded', function() {
            const savedTheme = localStorage.getItem('theme');
            const prefersDark = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches;
            
            // Aplicar tema salvo ou preferência do sistema
            if (savedTheme === 'dark' || (savedTheme === null && prefersDark)) {
                setTheme(true);
            } else {
                setTheme(false);
            }

            // Adicionar evento de clique ao botão de alternância de tema
            const themeToggle = document.getElementById('themeToggle');
            themeToggle.addEventListener('click', function() {
                const isDark = document.documentElement.classList.contains('dark-theme');
                setTheme(!isDark);
            });
        });

        // Atualizar tema quando a preferência do sistema mudar
        window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', e => {
            if (localStorage.getItem('theme') === null) {
                setTheme(e.matches);
            }
        });

          // Configurações da API
const API_BASE_URL = "https://api.jikan.moe/v4"

// Função para adicionar delay entre as requisições (para evitar rate limiting)
function delay(ms) {
  return new Promise((resolve) => setTimeout(resolve, ms))
}

// Classe para tradução automática
class Translator {
  constructor() {
    // Dicionário de termos comuns em inglês para português
    this.dictionary = {
      // Termos gerais
      episodes: "episódios",
      episode: "episódio",
      season: "temporada",
      winter: "inverno",
      spring: "primavera",
      summer: "verão",
      fall: "outono",
      rating: "classificação",
      status: "status",
      ongoing: "em andamento",
      "currently airing": "em exibição",
      "finished airing": "finalizado",
      "not yet aired": "ainda não exibido",
      completed: "completo",
      synopsis: "sinopse",
      type: "tipo",
      tv: "TV",
      movie: "filme",
      ova: "OVA",
      special: "especial",
      genres: "gêneros",
      characters: "personagens",
      staff: "equipe",
      reviews: "avaliações",
      recommendations: "recomendações",
      related: "relacionados",
      sequel: "sequência",
      prequel: "prequel",
      adaptation: "adaptação",
      "alternative version": "versão alternativa",
      "side story": "história paralela",
      summary: "resumo",
      "parent story": "história principal",
      "spin-off": "spin-off",
      character: "personagem",
      main: "principal",
      supporting: "secundário",
      background: "fundo",

      // Gêneros
      action: "ação",
      adventure: "aventura",
      comedy: "comédia",
      drama: "drama",
      fantasy: "fantasia",
      horror: "terror",
      mystery: "mistério",
      romance: "romance",
      "sci-fi": "ficção científica",
      "slice of life": "cotidiano",
      sports: "esportes",
      supernatural: "sobrenatural",
      thriller: "suspense",
      psychological: "psicológico",
      seinen: "seinen",
      shoujo: "shoujo",
      shounen: "shounen",
      music: "música",
      game: "jogo",
      harem: "harém",
      historical: "histórico",
      "martial arts": "artes marciais",
      military: "militar",
      school: "escolar",
      "super power": "super poder",
      vampire: "vampiro",
      magic: "magia",
      demons: "demônios",
      mecha: "mecha",
      samurai: "samurai",
      space: "espaço",
      cars: "carros",

      // Dias da semana
      monday: "segunda-feira",
      tuesday: "terça-feira",
      wednesday: "quarta-feira",
      thursday: "quinta-feira",
      friday: "sexta-feira",
      saturday: "sábado",
      sunday: "domingo",

      // Meses
      january: "janeiro",
      february: "fevereiro",
      march: "março",
      april: "abril",
      may: "maio",
      june: "junho",
      july: "julho",
      august: "agosto",
      september: "setembro",
      october: "outubro",
      november: "novembro",
      december: "dezembro",

      // Frases comuns
      "no synopsis available": "sinopse não disponível",
      "no information": "sem informações",
      unknown: "desconhecido",
      "not available": "não disponível",
      "no episodes available": "nenhum episódio disponível",
      "no characters available": "nenhum personagem disponível",
      "no reviews available": "nenhuma avaliação disponível",
      "no related anime available": "nenhum anime relacionado disponível",
      "no recommendations available": "nenhuma recomendação disponível",
      "no results found": "nenhum resultado encontrado",
      "search results for": "resultados da pesquisa para",
      loading: "carregando",
      error: "erro",
      "try again": "tentar novamente",
      back: "voltar",
      next: "próximo",
      previous: "anterior",
      page: "página",
      of: "de",
      "add to favorites": "adicionar aos favoritos",
      "remove from favorites": "remover dos favoritos",
      login: "entrar",
      logout: "sair",
      register: "registrar",
      username: "nome de usuário",
      password: "senha",
      email: "email",
      "confirm password": "confirmar senha",
      "forgot password": "esqueceu a senha",
      "remember me": "lembrar de mim",
      "sign in": "entrar",
      "sign up": "cadastrar",
      "sign in with google": "entrar com google",
      "sign up with google": "cadastrar com google",
      "already have an account": "já tem uma conta",
      "don't have an account": "não tem uma conta",
      "create account": "criar conta",
      settings: "configurações",
      profile: "perfil",
      help: "ajuda",
      about: "sobre",
      contact: "contato",
      terms: "termos",
      privacy: "privacidade",
      "dark mode": "modo escuro",
      "light mode": "modo claro",
      language: "idioma",
      notifications: "notificações",
      account: "conta",
      appearance: "aparência",
      save: "salvar",
      cancel: "cancelar",
      delete: "excluir",
      edit: "editar",
      update: "atualizar",
      search: "pesquisar",
      filter: "filtrar",
      sort: "ordenar",
      ascending: "crescente",
      descending: "decrescente",
      by: "por",
      name: "nome",
      date: "data",
      score: "pontuação",
      popularity: "popularidade",
      rank: "classificação",
      favorites: "favoritos",
      trending: "em alta",
      new: "novo",
      old: "antigo",
      all: "todos",
      none: "nenhum",
      select: "selecionar",
      clear: "limpar",
      apply: "aplicar",
      reset: "redefinir",
      "show more": "mostrar mais",
      "show less": "mostrar menos",
      "read more": "ler mais",
      "read less": "ler menos",
      "see more": "ver mais",
      "see less": "ver menos",
      "view all": "ver todos",
      "view less": "ver menos",
      "view more": "ver mais",
      "load more": "carregar mais",
      "load less": "carregar menos",
      "loading more": "carregando mais",
      "no more results": "não há mais resultados",
      "end of results": "fim dos resultados",
      "end of list": "fim da lista",
      "end of page": "fim da página",
      top: "topo",
      bottom: "rodapé",
      start: "início",
      end: "fim",
      first: "primeiro",
      last: "último",
      more: "mais",
      less: "menos",
      yes: "sim",
      no: "não",
      ok: "ok",
      done: "concluído",
      finish: "finalizar",
      complete: "completar",
      incomplete: "incompleto",
      success: "sucesso",
      failure: "falha",
      warning: "aviso",
      info: "informação",
      error: "erro",
      debug: "depuração",
      log: "registro",
      trace: "rastreamento",
      verbose: "detalhado",
      silent: "silencioso",
      on: "ligado",
      off: "desligado",
      enable: "habilitar",
      disable: "desabilitar",
      enabled: "habilitado",
      disabled: "desabilitado",
      active: "ativo",
      inactive: "inativo",
      activated: "ativado",
      deactivated: "desativado",
      open: "abrir",
      close: "fechar",
      opened: "aberto",
      closed: "fechado",
      show: "mostrar",
      hide: "ocultar",
      visible: "visível",
      invisible: "invisível",
      hidden: "oculto",
      shown: "mostrado",
      expand: "expandir",
      collapse: "recolher",
      expanded: "expandido",
      collapsed: "recolhido",
      increase: "aumentar",
      decrease: "diminuir",
      increased: "aumentado",
      decreased: "diminuído",
      add: "adicionar",
      remove: "remover",
      added: "adicionado",
      removed: "removido",
      create: "criar",
      delete: "excluir",
      created: "criado",
      deleted: "excluído",
      update: "atualizar",
      updated: "atualizado",
      edit: "editar",
      edited: "editado",
      save: "salvar",
      saved: "salvo",
      load: "carregar",
      loaded: "carregado",
      download: "baixar",
      downloaded: "baixado",
      upload: "enviar",
      uploaded: "enviado",
      share: "compartilhar",
      shared: "compartilhado",
      copy: "copiar",
      copied: "copiado",
      paste: "colar",
      pasted: "colado",
      cut: "recortar",
      cutted: "recortado",
      undo: "desfazer",
      redo: "refazer",
      undone: "desfeito",
      redone: "refeito",
      reset: "redefinir",
      resetted: "redefinido",
      restart: "reiniciar",
      restarted: "reiniciado",
      refresh: "atualizar",
      refreshed: "atualizado",
      reload: "recarregar",
      reloaded: "recarregado",
      retry: "tentar novamente",
      retried: "tentado novamente",
      skip: "pular",
      skipped: "pulado",
      continue: "continuar",
      continued: "continuado",
      pause: "pausar",
      paused: "pausado",
      play: "reproduzir",
      played: "reproduzido",
      stop: "parar",
      stopped: "parado",
      start: "iniciar",
      started: "iniciado",
      end: "finalizar",
      ended: "finalizado",
      finish: "terminar",
      finished: "terminado",
      complete: "completar",
      completed: "completado",
      incomplete: "incompleto",
      success: "sucesso",
      successful: "bem-sucedido",
      failure: "falha",
      failed: "falhou",
      error: "erro",
      errored: "com erro",
    }
  }

  // Traduzir texto para português
  async translate(text) {
    if (!text) return ""

    // Converter para minúsculas para facilitar a comparação
    const lowerText = text.toLowerCase()

    // Substituir palavras conhecidas
    for (const [en, pt] of Object.entries(this.dictionary)) {
      const regex = new RegExp("\\b" + en + "\\b", "gi")
      text = text.replace(regex, pt)
    }

    // Para textos longos, simular uma tradução mais completa
    // Isso é uma simulação, em um ambiente real usaríamos uma API de tradução
    if (text.length > 100) {
      // Adicionar alguns termos em português para simular uma tradução mais natural
      text = text
        .replace(/\bthe\b/gi, "o")
        .replace(/\ba\b/gi, "um")
        .replace(/\ban\b/gi, "um")
        .replace(/\bis\b/gi, "é")
        .replace(/\bare\b/gi, "são")
        .replace(/\bwas\b/gi, "foi")
        .replace(/\bwere\b/gi, "foram")
        .replace(/\bwill\b/gi, "irá")
        .replace(/\bhas\b/gi, "tem")
        .replace(/\bhave\b/gi, "têm")
        .replace(/\bhad\b/gi, "tinha")
        .replace(/\bwith\b/gi, "com")
        .replace(/\bfor\b/gi, "para")
        .replace(/\bfrom\b/gi, "de")
        .replace(/\bto\b/gi, "para")
        .replace(/\bin\b/gi, "em")
        .replace(/\bon\b/gi, "em")
        .replace(/\bat\b/gi, "em")
        .replace(/\bby\b/gi, "por")
        .replace(/\bof\b/gi, "de")
        .replace(/\band\b/gi, "e")
        .replace(/\bor\b/gi, "ou")
        .replace(/\bbut\b/gi, "mas")
        .replace(/\bif\b/gi, "se")
        .replace(/\bthen\b/gi, "então")
        .replace(/\belse\b/gi, "senão")
        .replace(/\bwhen\b/gi, "quando")
        .replace(/\bwhere\b/gi, "onde")
        .replace(/\bwhy\b/gi, "por que")
        .replace(/\bhow\b/gi, "como")
        .replace(/\bwhat\b/gi, "o que")
        .replace(/\bwho\b/gi, "quem")
        .replace(/\bwhich\b/gi, "qual")
        .replace(/\bthis\b/gi, "este")
        .replace(/\bthat\b/gi, "aquele")
        .replace(/\bthese\b/gi, "estes")
        .replace(/\bthose\b/gi, "aqueles")
        .replace(/\bhere\b/gi, "aqui")
        .replace(/\bthere\b/gi, "lá")
        .replace(/\bnow\b/gi, "agora")
        .replace(/\bthen\b/gi, "então")
        .replace(/\btoday\b/gi, "hoje")
        .replace(/\byesterday\b/gi, "ontem")
        .replace(/\btomorrow\b/gi, "amanhã")
        .replace(/\bweek\b/gi, "semana")
        .replace(/\bmonth\b/gi, "mês")
        .replace(/\byear\b/gi, "ano")
        .replace(/\btime\b/gi, "tempo")
        .replace(/\bday\b/gi, "dia")
        .replace(/\bnight\b/gi, "noite")
        .replace(/\bmorning\b/gi, "manhã")
        .replace(/\bevening\b/gi, "tarde")
        .replace(/\bafternoon\b/gi, "tarde")
    }

    return text
  }
}

// Instanciar o tradutor
const translator = new Translator()

// Função para lidar com erros de API
function handleApiError(error) {
  console.error("Erro na API Jikan:", error)
  return {
    error: true,
    message: "Ocorreu um erro ao buscar dados. Por favor, tente novamente mais tarde.",
  }
}

// Buscar animes em destaque (top animes)
async function buscarAnimesEmDestaque(limite = 10) {
  try {
    // Mostrar efeito de carregamento do Blogger
    startBloggerLoading()

    const response = await fetch(`${API_BASE_URL}/top/anime?limit=${limite}`)
    const data = await response.json()

    // Traduzir dados para português
    const animesEmPortugues = await Promise.all(
      data.data.map(async (anime) => {
        return {
          ...anime,
          title_portuguese: anime.title,
          synopsis_portuguese: await translator.translate(anime.synopsis || ""),
        }
      }),
    )

    // Esconder efeito de carregamento do Blogger
    stopBloggerLoading()

    return animesEmPortugues
  } catch (error) {
    stopBloggerLoading()
    return handleApiError(error)
  }
}

// Buscar animes da temporada atual
async function buscarAnimesDaTemporada(limite = 10) {
  try {
    startBloggerLoading()

    const response = await fetch(`${API_BASE_URL}/seasons/now?limit=${limite}`)
    const data = await response.json()

    // Traduzir dados para português
    const animesEmPortugues = await Promise.all(
      data.data.map(async (anime) => {
        return {
          ...anime,
          title_portuguese: anime.title,
          synopsis_portuguese: await translator.translate(anime.synopsis || ""),
        }
      }),
    )

    stopBloggerLoading()

    return animesEmPortugues
  } catch (error) {
    stopBloggerLoading()
    return handleApiError(error)
  }
}

// Buscar últimos episódios lançados
async function buscarUltimosEpisodios(limite = 10) {
  try {
    startBloggerLoading()

    const response = await fetch(`${API_BASE_URL}/watch/episodes?limit=${limite}`)
    const data = await response.json()

    // Traduzir dados para português
    const episodiosEmPortugues = await Promise.all(
      data.data.map(async (episodio) => {
        return {
          ...episodio,
          title_portuguese: episodio.anime.title,
          episode_title_portuguese: await translator.translate(episodio.title || ""),
        }
      }),
    )

    stopBloggerLoading()

    return episodiosEmPortugues
  } catch (error) {
    stopBloggerLoading()
    return handleApiError(error)
  }
}

// Buscar detalhes de um anime específico
async function buscarDetalhesAnime(animeId) {
  try {
    startBloggerLoading()

    const response = await fetch(`${API_BASE_URL}/anime/${animeId}/full`)
    const data = await response.json()

    // Traduzir dados para português
    const animeEmPortugues = {
      ...data.data,
      title_portuguese: data.data.title,
      synopsis_portuguese: await translator.translate(data.data.synopsis || ""),
      background_portuguese: await translator.translate(data.data.background || ""),
    }

    stopBloggerLoading()

    return animeEmPortugues
  } catch (error) {
    stopBloggerLoading()
    return handleApiError(error)
  }
}

// Buscar episódios de um anime específico
async function buscarEpisodiosAnime(animeId, pagina = 1) {
  try {
    startBloggerLoading()

    const response = await fetch(`${API_BASE_URL}/anime/${animeId}/episodes?page=${pagina}`)
    const data = await response.json()

    // Traduzir dados para português
    const episodiosEmPortugues = await Promise.all(
      data.data.map(async (episodio) => {
        return {
          ...episodio,
          title_portuguese: await translator.translate(episodio.title || ""),
        }
      }),
    )

    stopBloggerLoading()

    return {
      episodios: episodiosEmPortugues,
      paginacao: data.pagination,
    }
  } catch (error) {
    stopBloggerLoading()
    return handleApiError(error)
  }
}

// Buscar personagens de um anime específico
async function buscarPersonagensAnime(animeId) {
  try {
    startBloggerLoading()

    const response = await fetch(`${API_BASE_URL}/anime/${animeId}/characters`)
    const data = await response.json()

    // Traduzir dados para português
    const personagensEmPortugues = await Promise.all(
      data.data.map(async (personagem) => {
        return {
          ...personagem,
          role_portuguese: await translator.translate(personagem.role || ""),
          voice_actors: personagem.voice_actors || [],
        }
      }),
    )

    stopBloggerLoading()

    return personagensEmPortugues
  } catch (error) {
    stopBloggerLoading()
    return handleApiError(error)
  }
}

// Buscar imagens de um anime específico
async function buscarImagensAnime(animeId) {
  try {
    startBloggerLoading()

    const response = await fetch(`${API_BASE_URL}/anime/${animeId}/pictures`)
    const data = await response.json()

    stopBloggerLoading()

    return data.data
  } catch (error) {
    stopBloggerLoading()
    return handleApiError(error)
  }
}

// Buscar animes relacionados
async function buscarAnimesRelacionados(animeId) {
  try {
    startBloggerLoading()

    const response = await fetch(`${API_BASE_URL}/anime/${animeId}/relations`)
    const data = await response.json()

    stopBloggerLoading()

    return data.data
  } catch (error) {
    stopBloggerLoading()
    return handleApiError(error)
  }
}

// Buscar avaliações de um anime
async function buscarAvaliacoesAnime(animeId, pagina = 1) {
  try {
    startBloggerLoading()

    const response = await fetch(`${API_BASE_URL}/anime/${animeId}/reviews?page=${pagina}`)
    const data = await response.json()

    // Traduzir dados para português
    const avaliacoesEmPortugues = await Promise.all(
      data.data.map(async (avaliacao) => {
        return {
          ...avaliacao,
          review_portuguese: await translator.translate(avaliacao.review || ""),
        }
      }),
    )

    stopBloggerLoading()

    return {
      avaliacoes: avaliacoesEmPortugues,
      paginacao: data.pagination,
    }
  } catch (error) {
    stopBloggerLoading()
    return handleApiError(error)
  }
}

// Buscar trailers de um anime específico
async function buscarTrailersAnime(animeId) {
  try {
    startBloggerLoading()

    const response = await fetch(`${API_BASE_URL}/anime/${animeId}/videos`)
    const data = await response.json()

    stopBloggerLoading()

    return data.data
  } catch (error) {
    stopBloggerLoading()
    return handleApiError(error)
  }
}

// Buscar animes por termo de pesquisa
async function pesquisarAnimes(termo, pagina = 1, limite = 10) {
  try {
    startBloggerLoading()

    const response = await fetch(`${API_BASE_URL}/anime?q=${encodeURIComponent(termo)}&page=${pagina}&limit=${limite}`)
    const data = await response.json()

    // Traduzir dados para português
    const resultadosEmPortugues = await Promise.all(
      data.data.map(async (anime) => {
        return {
          ...anime,
          title_portuguese: anime.title,
          synopsis_portuguese: await translator.translate(anime.synopsis || ""),
        }
      }),
    )

    stopBloggerLoading()

    return {
      resultados: resultadosEmPortugues,
      paginacao: data.pagination,
    }
  } catch (error) {
    stopBloggerLoading()
    return handleApiError(error)
  }
}

// Buscar animes em alta
async function buscarAnimesEmAlta(pagina = 1, limite = 20) {
  try {
    startBloggerLoading()

    const response = await fetch(`${API_BASE_URL}/top/anime?page=${pagina}&limit=${limite}`)
    const data = await response.json()

    // Traduzir dados para português
    const animesEmPortugues = await Promise.all(
      data.data.map(async (anime) => {
        return {
          ...anime,
          title_portuguese: anime.title,
          synopsis_portuguese: await translator.translate(anime.synopsis || ""),
        }
      }),
    )

    stopBloggerLoading()

    return {
      animes: animesEmPortugues,
      paginacao: data.pagination,
    }
  } catch (error) {
    stopBloggerLoading()
    return handleApiError(error)
  }
}

// Buscar animes por temporada
async function buscarAnimesPorTemporada(ano, temporada, pagina = 1, limite = 20) {
  try {
    startBloggerLoading()

    const response = await fetch(`${API_BASE_URL}/seasons/${ano}/${temporada}?page=${pagina}&limit=${limite}`)
    const data = await response.json()

    // Traduzir dados para português
    const animesEmPortugues = await Promise.all(
      data.data.map(async (anime) => {
        return {
          ...anime,
          title_portuguese: anime.title,
          synopsis_portuguese: await translator.translate(anime.synopsis || ""),
        }
      }),
    )

    stopBloggerLoading()

    return {
      animes: animesEmPortugues,
      paginacao: data.pagination,
    }
  } catch (error) {
    stopBloggerLoading()
    return handleApiError(error)
  }
}

// Buscar animes por gênero
async function buscarAnimesPorGenero(generoId, pagina = 1, limite = 20) {
  try {
    startBloggerLoading()

    const response = await fetch(`${API_BASE_URL}/anime?genres=${generoId}&page=${pagina}&limit=${limite}`)
    const data = await response.json()

    // Traduzir dados para português
    const animesEmPortugues = await Promise.all(
      data.data.map(async (anime) => {
        return {
          ...anime,
          title_portuguese: anime.title,
          synopsis_portuguese: await translator.translate(anime.synopsis || ""),
        }
      }),
    )

    stopBloggerLoading()

    return {
      animes: animesEmPortugues,
      paginacao: data.pagination,
    }
  } catch (error) {
    stopBloggerLoading()
    return handleApiError(error)
  }
}

// Buscar gêneros de anime
async function buscarGeneros() {
  try {
    startBloggerLoading()

    const response = await fetch(`${API_BASE_URL}/genres/anime`)
    const data = await response.json()

    // Traduzir dados para português
    const generosEmPortugues = await Promise.all(
      data.data.map(async (genero) => {
        return {
          ...genero,
          name_portuguese: await translator.translate(genero.name || ""),
        }
      }),
    )

    stopBloggerLoading()

    return generosEmPortugues
  } catch (error) {
    stopBloggerLoading()
    return handleApiError(error)
  }
}

// Efeito de carregamento do Blogger
function startBloggerLoading() {
  const loadingBar = document.getElementById("bloggerLoadingBar")
  const loading = document.getElementById("bloggerLoading")

  loading.style.display = "block"
  loadingBar.style.width = "0%"

  // Animar a barra de progresso
  let width = 0
  const interval = setInterval(() => {
    if (width >= 90) {
      clearInterval(interval)
    } else {
      width += Math.random() * 10
      loadingBar.style.width = width + "%"
    }
  }, 200)

  return interval
}

function stopBloggerLoading() {
  const loadingBar = document.getElementById("bloggerLoadingBar")
  const loading = document.getElementById("bloggerLoading")

  // Completar a barra de progresso
  loadingBar.style.width = "100%"

  // Esconder após um pequeno delay
  setTimeout(() => {
    loading.style.display = "none"
    loadingBar.style.width = "0%"
  }, 300)
}

// Classe para gerenciar a autenticação
class AuthManager {
  constructor() {
    this.isLoggedIn = false
    this.currentUser = null
    this.users = this.loadUsers()
    this.accounts = this.loadAccounts()

    // Elementos do DOM
    this.loginModal = document.getElementById("loginModal")
    this.overlay = document.getElementById("overlay")
    this.loginForm = document.getElementById("loginForm")
    this.createAccountBtn = document.getElementById("createAccountBtn")
    this.loginBtn = document.getElementById("loginBtn")
    this.googleLoginBtn = document.getElementById("googleLoginBtn")
    this.userProfileBtn = document.getElementById("userProfileBtn")
    this.profilePopup = document.getElementById("profilePopup")
    this.closePopup = document.getElementById("closePopup")

    // Elementos de perfil
    this.userEmail = document.getElementById("userEmail")
    this.userName = document.getElementById("userName")
    this.userAvatar = document.getElementById("userAvatar")
    this.popupAvatar = document.getElementById("popupAvatar")

    // Elementos de edição de perfil
    this.editProfileBtn = document.getElementById("editProfileBtn")
    this.editProfileModal = document.getElementById("editProfileModal")
    this.profileName = document.getElementById("profileName")
    this.profileEmail = document.getElementById("profileEmail")
    this.editAvatarPreview = document.getElementById("editAvatarPreview")
    this.changeAvatarBtn = document.getElementById("changeAvatarBtn")
    this.avatarInput = document.getElementById("avatarInput")
    this.saveProfileBtn = document.getElementById("saveProfileBtn")

    // Elementos para adicionar nova conta
    this.addAccountBtn = document.getElementById("addAccountBtn")
    this.addAccountModal = document.getElementById("addAccountModal")
    this.addAccountForm = document.getElementById("addAccountForm")
    this.newEmail = document.getElementById("newEmail")
    this.newPassword = document.getElementById("newPassword")
    this.newName = document.getElementById("newName")
    this.addNewAccountBtn = document.getElementById("addNewAccountBtn")
    this.cancelAddAccountBtn = document.getElementById("cancelAddAccountBtn")

    // Botão de logout
    this.logoutBtn = document.getElementById("logoutBtn")

    this.init()
  }

  // Inicializar o gerenciador de autenticação
  init() {
    // Verificar se há um usuário logado
    this.checkLoggedInUser()

    // Adicionar event listeners
    this.addEventListeners()
  }

  // Carregar usuários do localStorage
  loadUsers() {
    const usersJson = localStorage.getItem("animeblog_users")
    return usersJson ? JSON.parse(usersJson) : []
  }

  // Carregar contas do localStorage
  loadAccounts() {
    const accountsJson = localStorage.getItem("animeblog_accounts")
    return accountsJson ? JSON.parse(accountsJson) : []
  }

  // Salvar usuários no localStorage
  saveUsers() {
    localStorage.setItem("animeblog_users", JSON.stringify(this.users))
  }

  // Salvar contas no localStorage
  saveAccounts() {
    localStorage.setItem("animeblog_accounts", JSON.stringify(this.accounts))
  }

  // Verificar se há um usuário logado
  checkLoggedInUser() {
    const loggedUserJson = localStorage.getItem("animeblog_current_user")
    if (loggedUserJson) {
      this.currentUser = JSON.parse(loggedUserJson)
      this.isLoggedIn = true
      this.updateUIForLoggedInUser()
    } else {
      this.showLoginModal()
    }
  }

  // Adicionar event listeners
  addEventListeners() {
    // Login form
    this.loginForm.addEventListener("submit", (e) => {
      e.preventDefault()
      this.handleLogin()
    })

    // Create account button
    this.createAccountBtn.addEventListener("click", () => {
      this.handleCreateAccount()
    })

    // Google login button
    this.googleLoginBtn.addEventListener("click", () => {
      this.handleGoogleLogin()
    })

    // User profile button
    this.userProfileBtn.addEventListener("click", () => {
      this.toggleProfilePopup()
    })

    // Close popup button
    this.closePopup.addEventListener("click", () => {
      this.hideProfilePopup()
    })

    // Edit profile button
    this.editProfileBtn.addEventListener("click", () => {
      this.showEditProfileModal()
    })

    // Change avatar button
    this.changeAvatarBtn.addEventListener("click", () => {
      this.avatarInput.click()
    })

    // Avatar input change
    this.avatarInput.addEventListener("change", (e) => {
      this.handleAvatarChange(e)
    })

    // Save profile button
    this.saveProfileBtn.addEventListener("click", () => {
      this.saveProfile()
    })
    console.log(
  "%c Criador do Template: SuspiroDev\n%c - Obrigado por comprar o template !",
  "color: #3498db; font-size: 16px; font-weight: bold; text-shadow: 1px 1px 3px #000;",
  "color: #2ecc71; font-size: 14px; font-weight: bold; text-shadow: 1px 1px 3px #000;"
);


    // Add account button
    this.addAccountBtn.addEventListener("click", () => {
      this.showAddAccountModal()
    })

    // Add account form
    this.addAccountForm.addEventListener("submit", (e) => {
      e.preventDefault()
      this.addNewAccount()
    })

    // Cancel add account button
    this.cancelAddAccountBtn.addEventListener("click", () => {
      this.hideAddAccountModal()
    })

    // Logout button
    this.logoutBtn.addEventListener("click", () => {
      this.handleLogout()
    })

    // Click outside to close popup
    document.addEventListener("click", (e) => {
      if (
        this.profilePopup.style.display === "block" &&
        !this.profilePopup.contains(e.target) &&
        !this.userProfileBtn.contains(e.target)
      ) {
        this.hideProfilePopup()
      }
    })
  }

  // Mostrar modal de login
  showLoginModal() {
    this.loginModal.style.display = "block"
    this.overlay.style.display = "block"
  }

  // Esconder modal de login
  hideLoginModal() {
    this.loginModal.style.display = "none"
    this.overlay.style.display = "none"
  }

  // Mostrar popup de perfil
  showProfilePopup() {
    this.profilePopup.style.display = "block"
  }

  // Esconder popup de perfil
  hideProfilePopup() {
    this.profilePopup.style.display = "none"
  }

  // Alternar exibição do popup de perfil
  toggleProfilePopup() {
    if (this.profilePopup.style.display === "block") {
      this.hideProfilePopup()
    } else {
      this.showProfilePopup()
    }
  }

  showEditProfileModal() {
    this.profileName.value = this.currentUser.name || ""
    this.profileEmail.value = this.currentUser.email || ""
    this.editAvatarPreview.src =
      this.currentUser.avatar ||
      "https://hebbkx1anhila5yf.public.blob.vercel-storage.com/Captura%20de%20tela%202025-03-24%20213027-TNmCDRAGaD4bMH7QEX5mc4craQCPnw.png"

    this.editProfileModal.style.display = "block"
    this.overlay.style.display = "block"
    this.hideProfilePopup()
  }

  hideEditProfileModal() {
    this.editProfileModal.style.display = "none"
    this.overlay.style.display = "none"
  }

  showAddAccountModal() {
    this.addAccountModal.style.display = "block"
    this.overlay.style.display = "block"
    this.hideProfilePopup()

    this.newEmail.value = ""
    this.newPassword.value = ""
    this.newName.value = ""
  }

  hideAddAccountModal() {
    this.addAccountModal.style.display = "none"
    this.overlay.style.display = "none"
  }

  handleAvatarChange(e) {
    const file = e.target.files[0]
    if (file) {
      const reader = new FileReader()
      reader.onload = (event) => {
        this.editAvatarPreview.src = event.target.result
      }
      reader.readAsDataURL(file)
    }
  }

  saveProfile() {
    if (!this.currentUser) return

    this.currentUser.name = this.profileName.value
    this.currentUser.avatar = this.editAvatarPreview.src

    localStorage.setItem("animeblog_current_user", JSON.stringify(this.currentUser))

    const userIndex = this.users.findIndex((u) => u.id === this.currentUser.id)
    if (userIndex !== -1) {
      this.users[userIndex] = this.currentUser
      this.saveUsers()
    }

    this.updateUIForLoggedInUser()

    this.hideEditProfileModal()

    alert("Perfil atualizado com sucesso!")
  }

  addNewAccount() {
    const email = this.newEmail.value
    const password = this.newPassword.value
    const name = this.newName.value || email.split("@")[0]

    if (!email || !password) {
      alert("Por favor, preencha todos os campos obrigatórios.")
      return
    }

    if (this.users.some((u) => u.email === email)) {
      alert("Este email já está em uso. Tente outro.")
      return
    }

    const newAccount = {
      id: Date.now().toString(),
      email: email,
      password: password,
      name: name,
      avatar:
        "https://hebbkx1anhila5yf.public.blob.vercel-storage.com/Captura%20de%20tela%202025-03-24%20213027-TNmCDRAGaD4bMH7QEX5mc4craQCPnw.png",
      createdAt: new Date().toISOString(),
      favorites: [],
    }

    this.users.push(newAccount)
    this.saveUsers()

    if (!this.accounts.some((a) => a.userId === this.currentUser.id)) {
      this.accounts.push({
        userId: this.currentUser.id,
        linkedAccounts: [],
      })
    }

    const accountIndex = this.accounts.findIndex((a) => a.userId === this.currentUser.id)
    if (accountIndex !== -1) {
      this.accounts[accountIndex].linkedAccounts.push(newAccount.id)
      this.saveAccounts()
    }

    this.hideAddAccountModal()

    alert("Conta adicionada com sucesso!")
  }

  updateUIForLoggedInUser() {
    if (this.currentUser) {
      this.userAvatar.src =
        this.currentUser.avatar ||
        "https://hebbkx1anhila5yf.public.blob.vercel-storage.com/Captura%20de%20tela%202025-03-24%20213027-TNmCDRAGaD4bMH7QEX5mc4craQCPnw.png"
      this.popupAvatar.src =
        this.currentUser.avatar ||
        "https://hebbkx1anhila5yf.public.blob.vercel-storage.com/Captura%20de%20tela%202025-03-24%20213027-TNmCDRAGaD4bMH7QEX5mc4craQCPnw.png"
      this.userEmail.textContent = this.currentUser.email
      this.userName.textContent = this.currentUser.name || this.currentUser.email.split("@")[0]

      this.hideLoginModal()
    }
  }

  handleLogin() {
    const email = document.getElementById("email").value
    const password = document.getElementById("password").value

    const user = this.users.find((u) => u.email === email && u.password === password)

    if (user) {
      this.currentUser = user
      this.isLoggedIn = true

      localStorage.setItem("animeblog_current_user", JSON.stringify(this.currentUser))

      this.updateUIForLoggedInUser()
    } else {
      alert("Email ou senha incorretos. Tente novamente.")
    }
  }

  handleCreateAccount() {
    const email = document.getElementById("email").value
    const password = document.getElementById("password").value

    if (!email || !password) {
      alert("Por favor, preencha todos os campos.")
      return
    }

    if (this.users.some((u) => u.email === email)) {
      alert("Este email já está em uso. Tente outro.")
      return
    }

    const newUser = {
      id: Date.now().toString(),
      email: email,
      password: password,
      name: email.split("@")[0],
      avatar:
        "https://hebbkx1anhila5yf.public.blob.vercel-storage.com/Captura%20de%20tela%202025-03-24%20213027-TNmCDRAGaD4bMH7QEX5mc4craQCPnw.png",
      createdAt: new Date().toISOString(),
      favorites: [],
    }

    this.users.push(newUser)
    this.saveUsers()

    this.currentUser = newUser
    this.isLoggedIn = true

    localStorage.setItem("animeblog_current_user", JSON.stringify(this.currentUser))

    this.updateUIForLoggedInUser()

    alert("Conta criada com sucesso!")
  }

  handleGoogleLogin() {
    const googleUser = {
      id: "google_" + Date.now().toString(),
      email: "usuario.google@gmail.com",
      name: "Usuário Google",
      avatar:
        "https://hebbkx1anhila5yf.public.blob.vercel-storage.com/Captura%20de%20tela%202025-03-24%20213027-TNmCDRAGaD4bMH7QEX5mc4craQCPnw.png",
      createdAt: new Date().toISOString(),
      favorites: [],
    }

    let existingUser = this.users.find((u) => u.email === googleUser.email)

    if (!existingUser) {
      this.users.push(googleUser)
      this.saveUsers()
      existingUser = googleUser
    }

    this.currentUser = existingUser
    this.isLoggedIn = true

    localStorage.setItem("animeblog_current_user", JSON.stringify(this.currentUser))

    this.updateUIForLoggedInUser()
  }

  handleLogout() {
    this.currentUser = null
    this.isLoggedIn = false

    localStorage.removeItem("animeblog_current_user")

    this.hideProfilePopup()
    this.showLoginModal()
  }

  isFavorite(animeId) {
    if (!this.currentUser || !this.currentUser.favorites) return false
    return this.currentUser.favorites.some((fav) => fav.id === animeId)
  }

  addToFavorites(anime) {
    if (!this.currentUser) return false

    if (!this.currentUser.favorites) {
      this.currentUser.favorites = []
    }

    if (this.isFavorite(anime.mal_id)) return false

    const favoriteAnime = {
      id: anime.mal_id,
      title: anime.title_portuguese || anime.title,
      image: anime.images.jpg.large_image_url,
      type: anime.type,
      score: anime.score,
      addedAt: new Date().toISOString(),
    }

    this.currentUser.favorites.push(favoriteAnime)

    localStorage.setItem("animeblog_current_user", JSON.stringify(this.currentUser))

    const userIndex = this.users.findIndex((u) => u.id === this.currentUser.id)
    if (userIndex !== -1) {
      this.users[userIndex] = this.currentUser
      this.saveUsers()
    }

    return true
  }

  removeFromFavorites(animeId) {
    if (!this.currentUser || !this.currentUser.favorites) return false

    if (!this.isFavorite(animeId)) return false

    this.currentUser.favorites = this.currentUser.favorites.filter((fav) => fav.id !== animeId)

    localStorage.setItem("animeblog_current_user", JSON.stringify(this.currentUser))

    const userIndex = this.users.findIndex((u) => u.id === this.currentUser.id)
    if (userIndex !== -1) {
      this.users[userIndex] = this.currentUser
      this.saveUsers()
    }

    return true
  }

  getFavorites() {
    if (!this.currentUser || !this.currentUser.favorites) return []
    return this.currentUser.favorites
  }
}

function formatarData(dataString) {
  if (!dataString) return "Data desconhecida"

  const data = new Date(dataString)

  if (isNaN(data.getTime())) return "Data desconhecida"

  return data.toLocaleDateString("pt-BR", {
    day: "2-digit",
    month: "2-digit",
    year: "numeric",
  })
}

function renderizarPaginacao(container, paginacao, paginaAtual, callback) {
  if (!paginacao || !paginacao.last_visible_page) {
    container.innerHTML = ""
    return
  }

  const totalPaginas = paginacao.last_visible_page

  if (totalPaginas <= 1) {
    container.innerHTML = ""
    return
  }

  let html = ""

  html += `
        <button class="pagination-button ${paginaAtual === 1 ? "disabled" : ""}" 
            ${paginaAtual === 1 ? "disabled" : ""} data-page="${paginaAtual - 1}">
            Anterior
        </button>
    `

  const maxPaginas = 5
  let inicio = Math.max(1, paginaAtual - Math.floor(maxPaginas / 2))
  const fim = Math.min(totalPaginas, inicio + maxPaginas - 1)

  if (fim - inicio + 1 < maxPaginas) {
    inicio = Math.max(1, fim - maxPaginas + 1)
  }

  for (let i = inicio; i <= fim; i++) {
    html += `
            <button class="pagination-button ${i === paginaAtual ? "active" : ""}" data-page="${i}">
                ${i}
            </button>
        `
  }

  html += `
        <button class="pagination-button ${paginaAtual === totalPaginas ? "disabled" : ""}" 
            ${paginaAtual === totalPaginas ? "disabled" : ""} data-page="${paginaAtual + 1}">
            Próximo
        </button>
    `

  container.innerHTML = html

  container.querySelectorAll(".pagination-button:not(.disabled)").forEach((button) => {
    button.addEventListener("click", () => {
      const pagina = Number.parseInt(button.dataset.page)
      callback(pagina)
    })
  })
}

class PageManager {
  constructor() {
    this.currentPage = "home"
    this.currentAnimeId = null
    this.currentSearchTerm = null
    this.currentGenreId = null
    this.currentYear = new Date().getFullYear()
    this.currentSeason = this.getCurrentSeason()
    this.homePage = document.getElementById("homePage")
    this.trendingPage = document.getElementById("trendingPage")
    this.seasonsPage = document.getElementById("seasonsPage")
    this.genresPage = document.getElementById("genresPage")
    this.favoritesPage = document.getElementById("favoritesPage")
    this.settingsPage = document.getElementById("settingsPage")
    this.helpPage = document.getElementById("helpPage")
    this.animeDetailsPage = document.getElementById("animeDetailsPage")
    this.searchResultsPage = document.getElementById("searchResultsPage")
    this.backToHome = document.getElementById("backToHome")
    this.backFromSearch = document.getElementById("backFromSearch")
    this.searchInput = document.getElementById("searchInput")
    this.searchSuggestions = document.getElementById("searchSuggestions")
    this.menuItems = document.querySelectorAll(".menu-item")
    this.seasonYear = document.getElementById("seasonYear")
    this.seasonName = document.getElementById("seasonName")
    this.imageModal = document.getElementById("imageModal")
    this.modalImage = document.getElementById("modalImage")
    this.closeImageModal = document.getElementById("closeImageModal")
    this.saveSettingsBtn = document.getElementById("saveSettingsBtn")
    this.termsLink = document.getElementById("termsLink")
    this.privacyLink = document.getElementById("privacyLink")
    this.contentPolicyLink = document.getElementById("contentPolicyLink")
    this.popupTermsLink = document.getElementById("popupTermsLink")
    this.popupPrivacyLink = document.getElementById("popupPrivacyLink")
    this.termsModal = document.getElementById("termsModal")
    this.privacyModal = document.getElementById("privacyModal")
    this.contentPolicyModal = document.getElementById("contentPolicyModal")
    this.closeTermsBtn = document.getElementById("closeTermsBtn")
    this.closePrivacyBtn = document.getElementById("closePrivacyBtn")
    this.closeContentPolicyBtn = document.getElementById("closeContentPolicyBtn")

    this.overlay = document.getElementById("overlay")

    this.init()
  }

  getCurrentSeason() {
    const month = new Date().getMonth() + 1 

    if (month >= 1 && month <= 3) return "winter"
    if (month >= 4 && month <= 6) return "spring"
    if (month >= 7 && month <= 9) return "summer"
    return "fall"
  }

  init() {
    this.addEventListeners()

    this.showPage("home")

    this.loadInitialData()

    this.fillYearSelector()
  }

  fillYearSelector() {
    const currentYear = new Date().getFullYear()
    let html = ""

    for (let year = currentYear; year >= 1990; year--) {
      html += `<option value="${year}" ${year === currentYear ? "selected" : ""}>${year}</option>`
    }

    this.seasonYear.innerHTML = html
  }

  addEventListeners() {
    this.backToHome.addEventListener("click", () => {
      this.showPage(this.previousPage || "home")
    })

    this.backFromSearch.addEventListener("click", () => {
      this.showPage(this.previousPage || "home")
    })

    this.searchInput.addEventListener("keypress", (e) => {
      if (e.key === "Enter") {
        const termo = this.searchInput.value.trim()
        if (termo) {
          this.searchAnimes(termo)
        }
      }
    })

    this.searchInput.addEventListener("input", () => {
      this.handleSearchSuggestions()
    })

    this.menuItems.forEach((item) => {
      item.addEventListener("click", () => {
        const section = item.dataset.section
        if (section) {
          this.handleMenuClick(section)
        }
      })
    })

    this.seasonYear.addEventListener("change", () => {
      this.currentYear = Number.parseInt(this.seasonYear.value)
      this.loadSeasonalAnimes()
    })

    this.seasonName.addEventListener("change", () => {
      this.currentSeason = this.seasonName.value
      this.loadSeasonalAnimes()
    })

    this.closeImageModal.addEventListener("click", () => {
      this.hideImageModal()
    })

    this.imageModal.addEventListener("click", (e) => {
      if (e.target === this.imageModal) {
        this.hideImageModal()
      }
    })

    document.addEventListener("keydown", (e) => {
      if (e.key === "Escape" && this.imageModal.style.display === "flex") {
        this.hideImageModal()
      }
    })

    this.saveSettingsBtn.addEventListener("click", () => {
      this.saveSettings()
    })

    this.termsLink.addEventListener("click", (e) => {
      e.preventDefault()
      this.showTermsModal()
    })

    this.privacyLink.addEventListener("click", (e) => {
      e.preventDefault()
      this.showPrivacyModal()
    })

    this.contentPolicyLink.addEventListener("click", (e) => {
      e.preventDefault()
      this.showContentPolicyModal()
    })

    this.popupTermsLink.addEventListener("click", (e) => {
      e.preventDefault()
      this.showTermsModal()
    })

    this.popupPrivacyLink.addEventListener("click", (e) => {
      e.preventDefault()
      this.showPrivacyModal()
    })

    this.closeTermsBtn.addEventListener("click", () => {
      this.hideTermsModal()
    })

    this.closePrivacyBtn.addEventListener("click", () => {
      this.hidePrivacyModal()
    })

    this.closeContentPolicyBtn.addEventListener("click", () => {
      this.hideContentPolicyModal()
    })
  }

  showTermsModal() {
    this.termsModal.style.display = "block"
    this.overlay.style.display = "block"
  }

  hideTermsModal() {
    this.termsModal.style.display = "none"
    this.overlay.style.display = "none"
  }

  showPrivacyModal() {
    this.privacyModal.style.display = "block"
    this.overlay.style.display = "block"
  }

  hidePrivacyModal() {
    this.privacyModal.style.display = "none"
    this.overlay.style.display = "none"
  }

  showContentPolicyModal() {
    this.contentPolicyModal.style.display = "block"
    this.overlay.style.display = "block"
  }

  hideContentPolicyModal() {
    this.contentPolicyModal.style.display = "none"
    this.overlay.style.display = "none"
  }

  saveSettings() {
    const darkMode = document.getElementById("darkMode").checked
    const language = document.querySelector('input[name="language"]:checked').id
    const notifyNewEpisodes = document.getElementById("notifyNewEpisodes").checked
    const notifyNewAnimes = document.getElementById("notifyNewAnimes").checked

    const settings = {
      darkMode,
      language,
      notifications: {
        newEpisodes: notifyNewEpisodes,
        newAnimes: notifyNewAnimes,
      },
    }

    localStorage.setItem("animeblog_settings", JSON.stringify(settings))

    if (darkMode) {
      document.body.classList.add("dark-mode")
    } else {
      document.body.classList.remove("dark-mode")
    }

    alert("Configurações salvas com sucesso!")
  }

  handleMenuClick(section) {
    this.showPage(section)
  }

  async handleSearchSuggestions() {
    const termo = this.searchInput.value.trim()

    if (termo.length < 2) {
  this.searchSuggestions.style.display = "none";
  return;
}


    try {
      const response = await fetch(`${API_BASE_URL}/anime?q=${encodeURIComponent(termo)}&limit=5`)
      const data = await response.json()

      if (data.data && data.data.length > 0) {
        let html = ""

        data.data.forEach((anime) => {
          const title = anime.title.replace(
            new RegExp(termo, "gi"),
            (match) => `<span class="search-highlight">${match}</span>`,
          )

          html += `
                        <div class="suggestion-item" data-id="${anime.mal_id}">
                            ${title}
                        </div>
                    `
        })

        this.searchSuggestions.innerHTML = html
        this.searchSuggestions.style.display = "block"

        this.searchSuggestions.querySelectorAll(".suggestion-item").forEach((item) => {
          item.addEventListener("click", () => {
            const animeId = item.dataset.id
            this.showAnimeDetails(animeId)
            this.searchSuggestions.style.display = "none"
            this.searchInput.value = item.textContent.trim()
          })
        })
      } else {
        this.searchSuggestions.style.display = "none"
      }
    } catch (error) {
      console.error("Erro ao buscar sugestões:", error)
      this.searchSuggestions.style.display = "none"
    }
  }

  async searchAnimes(termo) {
    this.currentSearchTerm = termo
    this.showPage("searchResults")

    const searchTerm = document.getElementById("searchTerm")
    const searchResults = document.getElementById("searchResults")
    const searchPagination = document.getElementById("searchPagination")

    searchTerm.textContent = termo
    searchResults.innerHTML = '<div class="loading">Carregando resultados...</div>'

    try {
      const resultado = await pesquisarAnimes(termo)

      if (!resultado || resultado.error) {
        searchResults.innerHTML = '<div class="error">Erro ao buscar resultados.</div>'
        return
      }

      const { resultados, paginacao } = resultado

      if (resultados.length === 0) {
        searchResults.innerHTML = '<div class="no-results">Nenhum resultado encontrado para sua pesquisa.</div>'
        return
      }

      let html = ""

      resultados.forEach((anime) => {
        html += `
                    <div class="anime-card" data-id="${anime.mal_id}">
                        <img src="${anime.images.jpg.large_image_url}" alt="${anime.title_portuguese}" class="anime-image">
                        <div class="anime-info">
                            <h3 class="anime-title">${anime.title_portuguese}</h3>
                            <div class="anime-details">
                                <span>${anime.type || "TV"}</span>
                                <span>${anime.score ? anime.score + "★" : "N/A"}</span>
                            </div>
                        </div>
                    </div>
                `
      })

      searchResults.innerHTML = html

      searchResults.querySelectorAll(".anime-card").forEach((card) => {
        card.addEventListener("click", () => {
          const animeId = card.dataset.id
          this.showAnimeDetails(animeId)
        })
      })

      renderizarPaginacao(searchPagination, paginacao, 1, (novaPagina) => {
        this.searchAnimesPage(termo, novaPagina)
      })
    } catch (error) {
      console.error("Erro ao pesquisar animes:", error)
      searchResults.innerHTML = '<div class="error">Ocorreu um erro ao buscar resultados.</div>'
    }
  }

  async searchAnimesPage(termo, pagina) {
    const searchResults = document.getElementById("searchResults")
    const searchPagination = document.getElementById("searchPagination")

    searchResults.innerHTML = '<div class="loading">Carregando resultados...</div>'

    try {
      const resultado = await pesquisarAnimes(termo, pagina)

      if (!resultado || resultado.error) {
        searchResults.innerHTML = '<div class="error">Erro ao buscar resultados.</div>'
        return
      }

      const { resultados, paginacao } = resultado

      if (resultados.length === 0) {
        searchResults.innerHTML = '<div class="no-results">Nenhum resultado encontrado para sua pesquisa.</div>'
        return
      }

      let html = ""

      resultados.forEach((anime) => {
        html += `
                    <div class="anime-card" data-id="${anime.mal_id}">
                        <img src="${anime.images.jpg.large_image_url}" alt="${anime.title_portuguese}" class="anime-image">
                        <div class="anime-info">
                            <h3 class="anime-title">${anime.title_portuguese}</h3>
                            <div class="anime-details">
                                <span>${anime.type || "TV"}</span>
                                <span>${anime.score ? anime.score + "★" : "N/A"}</span>
                            </div>
                        </div>
                    </div>
                `
      })

      searchResults.innerHTML = html

      searchResults.querySelectorAll(".anime-card").forEach((card) => {
        card.addEventListener("click", () => {
          const animeId = card.dataset.id
          this.showAnimeDetails(animeId)
        })
      })

      renderizarPaginacao(searchPagination, paginacao, pagina, (novaPagina) => {
        this.searchAnimesPage(termo, novaPagina)
      })
    } catch (error) {
      console.error("Erro ao pesquisar animes:", error)
      searchResults.innerHTML = '<div class="error">Ocorreu um erro ao buscar resultados.</div>'
    }
  }

  showPage(page) {
    if (this.currentPage !== page) {
      this.previousPage = this.currentPage
    }

    this.homePage.style.display = "none"
    this.trendingPage.style.display = "none"
    this.seasonsPage.style.display = "none"
    this.genresPage.style.display = "none"
    this.favoritesPage.style.display = "none"
    this.settingsPage.style.display = "none"
    this.helpPage.style.display = "none"
    this.animeDetailsPage.style.display = "none"
    this.searchResultsPage.style.display = "none"

    if (page === "home") {
      this.homePage.style.display = "block"
      this.currentPage = "home"
    } else if (page === "trending") {
      this.trendingPage.style.display = "block"
      this.currentPage = "trending"
      this.loadTrendingAnimes()
    } else if (page === "seasons") {
      this.seasonsPage.style.display = "block"
      this.currentPage = "seasons"
      this.loadSeasonalAnimes()
    } else if (page === "genres") {
      this.genresPage.style.display = "block"
      this.currentPage = "genres"
      this.loadGenres()
    } else if (page === "favorites") {
      this.favoritesPage.style.display = "block"
      this.currentPage = "favorites"
      this.loadFavorites()
    } else if (page === "settings") {
      this.settingsPage.style.display = "block"
      this.currentPage = "settings"
    } else if (page === "help") {
      this.helpPage.style.display = "block"
      this.currentPage = "help"
    } else if (page === "animeDetails") {
      this.animeDetailsPage.style.display = "block"
      this.currentPage = "animeDetails"
    } else if (page === "searchResults") {
      this.searchResultsPage.style.display = "block"
      this.currentPage = "searchResults"
    }

    this.updateMenu()
  }

  updateMenu() {
    this.menuItems.forEach((item) => {
      item.classList.remove("active")
    })

    const activeItem = document.querySelector(`.menu-item[data-section="${this.currentPage}"]`)
    if (activeItem) {
      activeItem.classList.add("active")
    }
  }

  async loadInitialData() {
    const animesDestaque = await buscarAnimesEmDestaque(12)
    this.renderizarAnimesDestaque(animesDestaque)

    await delay(1000)

    const ultimosEpisodios = await buscarUltimosEpisodios(8)
    this.renderizarUltimosEpisodios(ultimosEpisodios)

    await delay(1000)

    const animesDaTemporada = await buscarAnimesDaTemporada(12)
    this.renderizarAnimesDaTemporada(animesDaTemporada)
  }

  renderizarAnimesDestaque(animes) {
    const container = document.getElementById("featuredAnimes")

    if (!animes || animes.error) {
      container.innerHTML = `<div class="error">Erro ao carregar animes em destaque.</div>`
      return
    }

    let html = ""

    animes.forEach((anime) => {
      html += `
                <div class="anime-card" data-id="${anime.mal_id}">
                    <img src="${anime.images.jpg.large_image_url}" alt="${anime.title_portuguese}" class="anime-image">
                    <div class="anime-info">
                        <h3 class="anime-title">${anime.title_portuguese}</h3>
                        <div class="anime-details">
                            <span>${anime.type || "TV"}</span>
                            <span>${anime.score ? anime.score + "★" : "N/A"}</span>
                        </div>
                    </div>
                </div>
            `
    })

    container.innerHTML = html

    container.querySelectorAll(".anime-card").forEach((card) => {
      card.addEventListener("click", () => {
        const animeId = card.dataset.id
        this.showAnimeDetails(animeId)
      })
    })
  }

  renderizarUltimosEpisodios(episodios) {
    const container = document.getElementById("latestEpisodes")

    if (!episodios || episodios.error) {
      container.innerHTML = `<div class="error">Erro ao carregar últimos episódios.</div>`
      return
    }

    let html = ""

    episodios.forEach((episodio) => {
      html += `
                <div class="episode-card" data-id="${episodio.entry.mal_id}" data-episode="${episodio.episode}">
                    <img src="${episodio.entry.images.jpg.large_image_url}" alt="${episodio.title_portuguese}" class="episode-image">
                    <div class="episode-info">
                        <h3 class="episode-title">${episodio.title_portuguese}</h3>
                        <div class="episode-number">Episódio ${episodio.episode}</div>
                    </div>
                </div>
            `
    })

    container.innerHTML = html

    container.querySelectorAll(".episode-card").forEach((card) => {
      card.addEventListener("click", () => {
        const animeId = card.dataset.id
        this.showAnimeDetails(animeId)
      })
    })
  }

  renderizarAnimesDaTemporada(animes) {
    const container = document.getElementById("seasonAnimes")

    if (!animes || animes.error) {
      container.innerHTML = `<div class="error">Erro ao carregar animes da temporada.</div>`
      return
    }

    let html = ""

    animes.forEach((anime) => {
      html += `
                <div class="anime-card" data-id="${anime.mal_id}">
                    <img src="${anime.images.jpg.large_image_url}" alt="${anime.title_portuguese}" class="anime-image">
                    <div class="anime-info">
                        <h3 class="anime-title">${anime.title_portuguese}</h3>
                        <div class="anime-details">
                            <span>${anime.type || "TV"}</span>
                            <span>${anime.score ? anime.score + "★" : "N/A"}</span>
                        </div>
                    </div>
                </div>
            `
    })

    container.innerHTML = html

    container.querySelectorAll(".anime-card").forEach((card) => {
      card.addEventListener("click", () => {
        const animeId = card.dataset.id
        this.showAnimeDetails(animeId)
      })
    })
  }

  async showAnimeDetails(animeId) {
    this.currentAnimeId = animeId
    this.showPage("animeDetails")

    const loadingAnime = document.querySelector(".loading-anime")
    const animeHeader = document.getElementById("animeHeader")
    const animeCover = document.getElementById("animeCover")
    const animeTitle = document.getElementById("animeTitle")
    const animeType = document.getElementById("animeType")
    const animeYear = document.getElementById("animeYear")
    const animeStatus = document.getElementById("animeStatus")
    const animeScore = document.getElementById("animeScore")
    const animeGenres = document.getElementById("animeGenres")
    const animeSynopsis = document.getElementById("animeSynopsis")
    const favoriteButton = document.getElementById("favoriteButton")
    const animeTitlesAlt = document.getElementById("animeTitlesAlt")
    const animeAired = document.getElementById("animeAired")
    const animeStatusDetailed = document.getElementById("animeStatusDetailed")
    const animeBroadcast = document.getElementById("animeBroadcast")
    const animePremiered = document.getElementById("animePremiered")
    const animeThemes = document.getElementById("animeThemes")
    const animeDuration = document.getElementById("animeDuration")
    const animeRating = document.getElementById("animeRating")
    const animeScoreDetailed = document.getElementById("animeScoreDetailed")
    const animePopularity = document.getElementById("animePopularity")
    const animeMembers = document.getElementById("animeMembers")
    const animeFavorites = document.getElementById("animeFavorites")
    const animeProducers = document.getElementById("animeProducers")
    const animeStreaming = document.getElementById("animeStreaming")

    loadingAnime.style.display = "block"
    animeHeader.style.display = "none"

    try {
      const anime = await buscarDetalhesAnime(animeId)

      if (!anime || anime.error) {
        loadingAnime.textContent = "Erro ao carregar detalhes do anime."
        return
      }

      animeCover.src = anime.images.jpg.large_image_url
      animeCover.alt = anime.title_portuguese
      animeTitle.textContent = anime.title_portuguese
      animeType.textContent = anime.type || "TV"
      animeYear.textContent = anime.year || "N/A"
      animeStatus.textContent = (await translator.translate(anime.status)) || "N/A"
      animeScore.textContent = anime.score ? anime.score + "★" : "N/A"

      let generosHTML = ""
      if (anime.genres && anime.genres.length > 0) {
        for (const genero of anime.genres) {
          const generoTraduzido = await translator.translate(genero.name)
          generosHTML += `<span>${generoTraduzido}</span>`
        }
        animeGenres.innerHTML = generosHTML
      }

      animeSynopsis.textContent = anime.synopsis_portuguese || "Sem sinopse disponível."

      let titulosAlt = ""
      if (anime.title_english) titulosAlt += `Inglês: ${anime.title_english}<br>`
      if (anime.title_japanese) titulosAlt += `Japonês: ${anime.title_japanese}<br>`
      if (anime.title_synonyms && anime.title_synonyms.length > 0) {
        titulosAlt += `Sinônimos: ${anime.title_synonyms.join(", ")}`
      }
      animeTitlesAlt.innerHTML = titulosAlt || "N/A"

      animeAired.innerHTML = anime.aired
        ? `${formatarData(anime.aired.from)} até ${anime.aired.to ? formatarData(anime.aired.to) : "Presente"}`
        : "N/A"

      animeStatusDetailed.textContent = (await translator.translate(anime.status)) || "N/A"

      animeBroadcast.textContent = anime.broadcast ? await translator.translate(anime.broadcast.string) : "N/A"

      animePremiered.textContent =
        anime.season && anime.year ? `${await translator.translate(anime.season)} ${anime.year}` : "N/A"

      let temasHTML = ""
      if (anime.themes && anime.themes.length > 0) {
        const temas = await Promise.all(anime.themes.map(async (tema) => await translator.translate(tema.name)))
        temasHTML = temas.join(", ")
      }
      animeThemes.textContent = temasHTML || "N/A"

      animeDuration.textContent = anime.duration || "N/A"

      animeRating.textContent = (await translator.translate(anime.rating)) || "N/A"

      animeScoreDetailed.textContent = anime.score
        ? `${anime.score} (${anime.scored_by.toLocaleString()} votos)`
        : "N/A"

      animePopularity.textContent = anime.popularity ? `#${anime.popularity}` : "N/A"

      animeMembers.textContent = anime.members ? anime.members.toLocaleString() : "N/A"

      animeFavorites.textContent = anime.favorites ? anime.favorites.toLocaleString() : "N/A"

      let produtoresHTML = ""
      if (anime.producers && anime.producers.length > 0) {
        produtoresHTML = anime.producers.map((produtor) => produtor.name).join(", ")
      }
      animeProducers.textContent = produtoresHTML || "N/A"

      let streamingHTML = ""
      if (anime.streaming && anime.streaming.length > 0) {
        anime.streaming.forEach((plataforma) => {
          streamingHTML += `<div class="platform-item">${plataforma.name}</div>`
        })
      }
      animeStreaming.innerHTML = streamingHTML || "Não disponível"

      this.updateFavoriteButton(anime)

      loadingAnime.style.display = "none"
      animeHeader.style.display = "flex"

      this.carregarEpisodios(animeId)

      document.querySelectorAll(".tab-button").forEach((button) => {
        button.addEventListener("click", () => {
          document.querySelectorAll(".tab-button").forEach((btn) => {
            btn.classList.remove("active")
          })

          button.classList.add("active")

          document.querySelectorAll(".tab-pane").forEach((pane) => {
            pane.classList.remove("active")
          })

          const tabId = button.dataset.tab + "Tab"
          document.getElementById(tabId).classList.add("active")

          const tabName = button.dataset.tab
          if (tabName === "episodes") {
            this.carregarEpisodios(animeId)
          } else if (tabName === "characters") {
            this.carregarPersonagens(animeId)
          } else if (tabName === "images") {
            this.carregarImagens(animeId)
          } else if (tabName === "related") {
            this.carregarAnimesRelacionados(animeId)
          } else if (tabName === "reviews") {
            this.carregarAvaliacoes(animeId)
          } else if (tabName === "trailers") {
            this.carregarTrailers(animeId)
          }
        })
      })

      favoriteButton.addEventListener("click", () => {
        this.toggleFavorite(anime)
      })
    } catch (error) {
      console.error("Erro ao carregar detalhes do anime:", error)
      loadingAnime.textContent = "Ocorreu um erro ao carregar os detalhes do anime."
    }
  }

  updateFavoriteButton(anime) {
    const favoriteButton = document.getElementById("favoriteButton")
    const isFavorite = window.authManager.isFavorite(anime.mal_id)

    if (isFavorite) {
      favoriteButton.innerHTML = '<i class="material-icons">favorite</i> Remover dos Favoritos'
      favoriteButton.classList.add("active")
    } else {
      favoriteButton.innerHTML = '<i class="material-icons">favorite_border</i> Adicionar aos Favoritos'
      favoriteButton.classList.remove("active")
    }
  }

  toggleFavorite(anime) {
    const isFavorite = window.authManager.isFavorite(anime.mal_id)

    if (isFavorite) {
      window.authManager.removeFromFavorites(anime.mal_id)
    } else {
      window.authManager.addToFavorites(anime)
    }

    this.updateFavoriteButton(anime)
  }

  async carregarEpisodios(animeId, pagina = 1) {
            const episodesList = document.getElementById("episodesList");
            const episodesPagination = document.getElementById("episodesPagination");
            
            // Check if video player container exists, if not create it
            let videoPlayerContainer = document.getElementById("videoPlayerContainer");
            if (!videoPlayerContainer) {
                videoPlayerContainer = document.createElement("div");
                videoPlayerContainer.id = "videoPlayerContainer";
                videoPlayerContainer.className = "video-player-container";
                
                const videoTitle = document.createElement("div");
                videoTitle.id = "videoTitle";
                videoTitle.className = "video-title";
                videoPlayerContainer.appendChild(videoTitle);
                
                const videoPlayer = document.createElement("video");
                videoPlayer.id = "videoPlayer";
                videoPlayer.className = "video-js vjs-default-skin video-player";
                videoPlayer.controls = true;
                videoPlayer.preload = "auto";
                videoPlayerContainer.appendChild(videoPlayer);
                
                // Insert video player at the top of episodes tab
                const episodesTab = document.getElementById("episodesTab");
                episodesTab.insertBefore(videoPlayerContainer, episodesTab.firstChild);
            }

            episodesList.innerHTML = '<div class="loading">Carregando episódios...</div>';

            try {
                // Get anime details to get the title
                const anime = await buscarDetalhesAnime(animeId);
                if (!anime || anime.error) {
                    episodesList.innerHTML = '<div class="error">Erro ao carregar detalhes do anime.</div>';
                    return;
                }
                
                const animeTitle = anime.title;
                // Store anime title for later use
                episodesList.dataset.animeTitle = animeTitle;
                
                const resultado = await buscarEpisodiosAnime(animeId, pagina);

                if (!resultado || resultado.error) {
                    episodesList.innerHTML = '<div class="error">Erro ao carregar episódios.</div>';
                    return;
                }

                const { episodios, paginacao } = resultado;

                if (episodios.length === 0) {
                    episodesList.innerHTML = '<div class="no-data">Nenhum episódio disponível.</div>';
                    return;
                }

                let html = "";

                episodios.forEach((episodio) => {
                    html += `
                        <div class="episode-item" data-episode="${episodio.mal_id}" data-title="${episodio.title_portuguese || 'Episódio ' + episodio.mal_id}">
                            <div class="episode-number">${episodio.mal_id}</div>
                            <div class="episode-title">${episodio.title_portuguese || "Sem título"}</div>
                            <div class="episode-date">${formatarData(episodio.aired)}</div>
                        </div>
                    `;
                });

                episodesList.innerHTML = html;

                // Add click event to each episode
                episodesList.querySelectorAll(".episode-item").forEach((item) => {
                    item.addEventListener("click", function() {
                        // Remove active class from all episodes
                        episodesList.querySelectorAll(".episode-item").forEach(ep => ep.classList.remove("active"));
                        
                        // Add active class to clicked episode
                        this.classList.add("active");
                        
                        const episodeNumber = this.dataset.episode;
const episodeTitle = this.dataset.title;
const animeTitle = episodesList.dataset.animeTitle.trim(); // Remove espaços extras

// Format episode number with leading zero if needed
const formattedEpisodeNumber = episodeNumber.toString().padStart(2, '0');

// Get the first letter/initial of anime title for the URL
const animeInitial = animeTitle.charAt(0).toUpperCase();

// Lista de palavras que devem permanecer minúsculas
const lowercaseWords = ["no", "of", "the", "da", "de", "do", "dos", "das"];

// Format anime name for URL (capitalize first word, lowercase certain words)
const formattedAnimeTitle = animeTitle
  .toLowerCase()
  .split(' ')
  .map((word, index) => lowercaseWords.includes(word) && index !== 0 ? word : word.charAt(0).toUpperCase() + word.slice(1))
  .join(' ') // Mantemos espaços temporariamente
  .replace(/,/g, '%2C') // Substitui vírgulas por %2C
  .replace(/\s/g, '%20'); // Substitui espaços por %20

// Adicionar um espaço codificado antes do título do anime
const formattedAnimeTitleWithSpace = `%20${formattedAnimeTitle}`;

// Criar a URL do vídeo no formato correto
const videoUrl = `https://animeflix.blog/Animes/Letra-${animeInitial}/${formattedAnimeTitleWithSpace}/${formattedEpisodeNumber}.mp4`;

console.log(videoUrl); // Para verificar se o URL está correto




         
                        // Update video title
                        document.getElementById("videoTitle").textContent = `${animeTitle} - ${episodeTitle}`;
                        
// Mostrar o player de vídeo
const videoPlayerContainer = document.getElementById("videoPlayerContainer");
videoPlayerContainer.style.display = "block";

// Remover player antigo, se existir
if (window.videoJS) {
    window.videoJS.dispose();
}

// Pegar o elemento do player
const videoElement = document.getElementById("videoPlayer");
videoElement.innerHTML = ''; // Limpar qualquer source existente

// Criar novo elemento source
const sourceElement = document.createElement("source");
sourceElement.src = videoUrl;
sourceElement.type = "video/mp4"; // Mantemos o formato correto
videoElement.appendChild(sourceElement);

// Inicializar Video.js
window.videoJS = videojs("videoPlayer", {
    controls: true,
    autoplay: false,
    preload: "auto",
    fluid: true,
    responsive: true,
    playbackRates: [0.5, 1, 1.5, 2]
});

// Rolar até o player
videoPlayerContainer.scrollIntoView({ behavior: "smooth" });
                    });
                });


                renderizarPaginacao(episodesPagination, paginacao, pagina, (novaPagina) => {
                    carregarEpisodios(animeId, novaPagina);
                });
            } catch (error) {
                console.error("Erro ao carregar episódios:", error);
                episodesList.innerHTML = '<div class="error">Ocorreu um erro ao carregar os episódios.</div>';
            }
        }

        async carregarPersonagens(animeId) {
  const charactersGrid = document.getElementById("charactersGrid")

  charactersGrid.innerHTML = '<div class="loading">Carregando personagens...</div>'

  try {
    const personagens = await buscarPersonagensAnime(animeId)

    if (!personagens || personagens.error) {
      charactersGrid.innerHTML = '<div class="error">Erro ao carregar personagens.</div>'
      return
    }

    if (personagens.length === 0) {
      charactersGrid.innerHTML = '<div class="no-data">Nenhum personagem disponível.</div>'
      return
    }

    let html = ""

    personagens.forEach((personagem) => {
      const voiceActor = personagem.voice_actors && personagem.voice_actors.length > 0 ? personagem.voice_actors[0] : null

      html += `
        <div class="character-card">
          <img src="${personagem.character.images.jpg.image_url}" alt="${personagem.character.name}" class="character-image">
          <div class="character-info">
            <h3 class="character-name">${personagem.character.name}</h3>
            <div class="character-role">${personagem.role_portuguese || personagem.role}</div>
            ${voiceActor ? `<div class="character-voice">${voiceActor.person.name}</div>` : ''}
          </div>
        </div>
      `
    })

    charactersGrid.innerHTML = html
  } catch (error) {
    console.error("Erro ao carregar personagens:", error)
    charactersGrid.innerHTML = '<div class="error">Ocorreu um erro ao carregar os personagens.</div>'
  }
}

async carregarImagens(animeId) {
  const imagesGrid = document.getElementById("imagesGrid")

  imagesGrid.innerHTML = '<div class="loading">Carregando imagens...</div>'

  try {
    const imagens = await buscarImagensAnime(animeId)

    if (!imagens || imagens.error) {
      imagesGrid.innerHTML = '<div class="error">Erro ao carregar imagens.</div>'
      return
    }

    if (imagens.length === 0) {
      imagesGrid.innerHTML = '<div class="no-data">Nenhuma imagem disponível.</div>'
      return
    }

    let html = ""

    imagens.forEach((imagem) => {
      html += `
        <div class="image-card" data-url="${imagem.jpg.large_image_url}">
          <img src="${imagem.jpg.image_url}" alt="Imagem do anime" class="anime-gallery-image">
          <div class="image-type">Imagem</div>
        </div>
      `
    })

    imagesGrid.innerHTML = html

    imagesGrid.querySelectorAll(".image-card").forEach((card) => {
      card.addEventListener("click", () => {
        this.showImageModal(card.dataset.url)
      })
    })
  } catch (error) {
    console.error("Erro ao carregar imagens:", error)
    imagesGrid.innerHTML = '<div class="error">Ocorreu um erro ao carregar as imagens.</div>'
  }
}

showImageModal(imageUrl) {
  const modalImage = document.getElementById("modalImage")
  const imageModal = document.getElementById("imageModal")

  modalImage.src = imageUrl
  imageModal.style.display = "flex"
}

hideImageModal() {
  const imageModal = document.getElementById("imageModal")
  imageModal.style.display = "none"
}

async carregarAnimesRelacionados(animeId) {
  const relatedAnime = document.getElementById("relatedAnime")

  relatedAnime.innerHTML = '<div class="loading">Carregando animes relacionados...</div>'

  try {
    const relacionados = await buscarAnimesRelacionados(animeId)

    if (!relacionados || relacionados.error) {
      relatedAnime.innerHTML = '<div class="error">Erro ao carregar animes relacionados.</div>'
      return
    }

    if (relacionados.length === 0) {
      relatedAnime.innerHTML = '<div class="no-data">Nenhum anime relacionado disponível.</div>'
      return
    }

    let html = ""

    relacionados.forEach((relacao) => {
      relacao.entry.forEach((anime) => {
        if (anime.type === "anime") {
          html += `
            <div class="anime-card" data-id="${anime.mal_id}">
              <img src="${anime.images.jpg.large_image_url}" alt="${anime.name}" class="anime-image">
              <div class="anime-info">
                <h3 class="anime-title">${anime.name}</h3>
                <div class="anime-details">
                  <span>${anime.type || "TV"}</span>
                  <span>${relacao.relation}</span>
                </div>
              </div>
            </div>
          `
        }
      })
    })

    if (html === "") {
      relatedAnime.innerHTML = '<div class="no-data">Nenhum anime relacionado disponível.</div>'
      return
    }

    relatedAnime.innerHTML = html

    relatedAnime.querySelectorAll(".anime-card").forEach((card) => {
      card.addEventListener("click", () => {
        const animeId = card.dataset.id
        this.showAnimeDetails(animeId)
      })
    })
  } catch (error) {
    console.error("Erro ao carregar animes relacionados:", error)
    relatedAnime.innerHTML = '<div class="error">Ocorreu um erro ao carregar os animes relacionados.</div>'
  }
}

async carregarAvaliacoes(animeId, pagina = 1) {
  const reviewsList = document.getElementById("reviewsList")

  reviewsList.innerHTML = '<div class="loading">Carregando avaliações...</div>'

  try {
    const resultado = await buscarAvaliacoesAnime(animeId, pagina)

    if (!resultado || resultado.error) {
      reviewsList.innerHTML = '<div class="error">Erro ao carregar avaliações.</div>'
      return
    }

    const { avaliacoes, paginacao } = resultado

    if (avaliacoes.length === 0) {
      reviewsList.innerHTML = '<div class="no-data">Nenhuma avaliação disponível.</div>'
      return
    }

    let html = ""

    avaliacoes.forEach((avaliacao) => {
      html += `
        <div class="review-item">
          <div class="review-header">
            <div class="reviewer">${avaliacao.user.username}</div>
            <div class="review-score">${avaliacao.score} / 10</div>
          </div>
          <div class="review-content">${avaliacao.review_portuguese.substring(0, 300)}${
        avaliacao.review_portuguese.length > 300 ? "..." : ""
      }</div>
        </div>
      `
    })

    reviewsList.innerHTML = html
  } catch (error) {
    console.error("Erro ao carregar avaliações:", error)
    reviewsList.innerHTML = '<div class="error">Ocorreu um erro ao carregar as avaliações.</div>'
  }
}

async carregarTrailers(animeId) {
  const trailersContainer = document.getElementById("trailersContainer")

  trailersContainer.innerHTML = '<div class="loading">Carregando trailers...</div>'

  try {
    const trailers = await buscarTrailersAnime(animeId)

    if (!trailers || trailers.error) {
      trailersContainer.innerHTML = '<div class="error">Erro ao carregar trailers.</div>'
      return
    }

    if (!trailers.promo || trailers.promo.length === 0) {
      trailersContainer.innerHTML = '<div class="no-data">Nenhum trailer disponível.</div>'
      return
    }

    let html = ""

    trailers.promo.forEach((trailer) => {
      html += `
        <div class="trailer-item">
          <iframe class="trailer-video" width="100%" height="315" src="https://www.youtube.com/embed/${
            trailer.trailer.youtube_id
          }" frameborder="0" allowfullscreen></iframe>
          <h3>${trailer.title || "Trailer"}</h3>
        </div>
      `
    })

    trailersContainer.innerHTML = html
  } catch (error) {
    console.error("Erro ao carregar trailers:", error)
    trailersContainer.innerHTML = '<div class="error">Ocorreu um erro ao carregar os trailers.</div>'
  }
}

async loadTrendingAnimes(pagina = 1) {
  const trendingAnimes = document.getElementById("trendingAnimes")
  const trendingPagination = document.getElementById("trendingPagination")

  trendingAnimes.innerHTML = '<div class="loading">Carregando animes em alta...</div>'

  try {
    const resultado = await buscarAnimesEmAlta(pagina)

    if (!resultado || resultado.error) {
      trendingAnimes.innerHTML = '<div class="error">Erro ao carregar animes em alta.</div>'
      return
    }

    const { animes, paginacao } = resultado

    if (animes.length === 0) {
      trendingAnimes.innerHTML = '<div class="no-data">Nenhum anime em alta disponível.</div>'
      return
    }

    let html = ""

    animes.forEach((anime) => {
      html += `
        <div class="anime-card" data-id="${anime.mal_id}">
          <img src="${anime.images.jpg.large_image_url}" alt="${anime.title_portuguese}" class="anime-image">
          <div class="anime-info">
            <h3 class="anime-title">${anime.title_portuguese}</h3>
            <div class="anime-details">
              <span>${anime.type || "TV"}</span>
              <span>${anime.score ? anime.score + "★" : "N/A"}</span>
            </div>
          </div>
        </div>
      `
    })

    trendingAnimes.innerHTML = html

    trendingAnimes.querySelectorAll(".anime-card").forEach((card) => {
      card.addEventListener("click", () => {
        const animeId = card.dataset.id
        this.showAnimeDetails(animeId)
      })
    })

    renderizarPaginacao(trendingPagination, paginacao, pagina, (novaPagina) => {
      this.loadTrendingAnimes(novaPagina)
    })
  } catch (error) {
    console.error("Erro ao carregar animes em alta:", error)
    trendingAnimes.innerHTML = '<div class="error">Ocorreu um erro ao carregar os animes em alta.</div>'
  }
}

async loadSeasonalAnimes(pagina = 1) {
  const seasonalAnimes = document.getElementById("seasonalAnimes")
  const seasonalPagination = document.getElementById("seasonalPagination")

  seasonalAnimes.innerHTML = '<div class="loading">Carregando animes da temporada...</div>'

  try {
    const resultado = await buscarAnimesPorTemporada(this.currentYear, this.currentSeason, pagina)

    if (!resultado || resultado.error) {
      seasonalAnimes.innerHTML = '<div class="error">Erro ao carregar animes da temporada.</div>'
      return
    }

    const { animes, paginacao } = resultado

    if (animes.length === 0) {
      seasonalAnimes.innerHTML = '<div class="no-data">Nenhum anime disponível para esta temporada.</div>'
      return
    }

    let html = ""

    animes.forEach((anime) => {
      html += `
        <div class="anime-card" data-id="${anime.mal_id}">
          <img src="${anime.images.jpg.large_image_url}" alt="${anime.title_portuguese}" class="anime-image">
          <div class="anime-info">
            <h3 class="anime-title">${anime.title_portuguese}</h3>
            <div class="anime-details">
              <span>${anime.type || "TV"}</span>
              <span>${anime.score ? anime.score + "★" : "N/A"}</span>
            </div>
          </div>
        </div>
      `
    })

    seasonalAnimes.innerHTML = html

    seasonalAnimes.querySelectorAll(".anime-card").forEach((card) => {
      card.addEventListener("click", () => {
        const animeId = card.dataset.id
        this.showAnimeDetails(animeId)
      })
    })

    renderizarPaginacao(seasonalPagination, paginacao, pagina, (novaPagina) => {
      this.loadSeasonalAnimes(novaPagina)
    })
  } catch (error) {
    console.error("Erro ao carregar animes da temporada:", error)
    seasonalAnimes.innerHTML = '<div class="error">Ocorreu um erro ao carregar os animes da temporada.</div>'
  }
}

async loadGenres() {
  const genreFilters = document.getElementById("genreFilters")
  const genreAnimes = document.getElementById("genreAnimes")

  genreFilters.innerHTML = '<div class="loading">Carregando gêneros...</div>'
  genreAnimes.innerHTML = '<div class="loading">Selecione um gênero para ver os animes...</div>'

  try {
    const generos = await buscarGeneros()

    if (!generos || generos.error) {
      genreFilters.innerHTML = '<div class="error">Erro ao carregar gêneros.</div>'
      return
    }

    if (generos.length === 0) {
      genreFilters.innerHTML = '<div class="no-data">Nenhum gênero disponível.</div>'
      return
    }

    let html = ""

    generos.forEach((genero) => {
      html += `
        <div class="genre-filter" data-id="${genero.mal_id}">${genero.name_portuguese || genero.name}</div>
      `
    })

    genreFilters.innerHTML = html

    genreFilters.querySelectorAll(".genre-filter").forEach((filter) => {
      filter.addEventListener("click", () => {
        genreFilters.querySelectorAll(".genre-filter").forEach((f) => {
          f.classList.remove("active")
        })

        filter.classList.add("active")

        const generoId = filter.dataset.id
        this.currentGenreId = generoId
        this.loadAnimesByGenre(generoId)
      })
    })
  } catch (error) {
    console.error("Erro ao carregar gêneros:", error)
    genreFilters.innerHTML = '<div class="error">Ocorreu um erro ao carregar os gêneros.</div>'
  }
}

async loadAnimesByGenre(generoId, pagina = 1) {
  const genreAnimes = document.getElementById("genreAnimes")
  const genrePagination = document.getElementById("genrePagination")

  genreAnimes.innerHTML = '<div class="loading">Carregando animes...</div>'

  try {
    const resultado = await buscarAnimesPorGenero(generoId, pagina)

    if (!resultado || resultado.error) {
      genreAnimes.innerHTML = '<div class="error">Erro ao carregar animes.</div>'
      return
    }

    const { animes, paginacao } = resultado

    if (animes.length === 0) {
      genreAnimes.innerHTML = '<div class="no-data">Nenhum anime disponível para este gênero.</div>'
      return
    }

    let html = ""

    animes.forEach((anime) => {
      html += `
        <div class="anime-card" data-id="${anime.mal_id}">
          <img src="${anime.images.jpg.large_image_url}" alt="${anime.title_portuguese}" class="anime-image">
          <div class="anime-info">
            <h3 class="anime-title">${anime.title_portuguese}</h3>
            <div class="anime-details">
              <span>${anime.type || "TV"}</span>
              <span>${anime.score ? anime.score + "★" : "N/A"}</span>
            </div>
          </div>
        </div>
      `
    })

    genreAnimes.innerHTML = html

    genreAnimes.querySelectorAll(".anime-card").forEach((card) => {
      card.addEventListener("click", () => {
        const animeId = card.dataset.id
        this.showAnimeDetails(animeId)
      })
    })

    renderizarPaginacao(genrePagination, paginacao, pagina, (novaPagina) => {
      this.loadAnimesByGenre(generoId, novaPagina)
    })
  } catch (error) {
    console.error("Erro ao carregar animes por gênero:", error)
    genreAnimes.innerHTML = '<div class="error">Ocorreu um erro ao carregar os animes.</div>'
  }
}

loadFavorites() {
  const favoriteAnimes = document.getElementById("favoriteAnimes")

  const favorites = window.authManager.getFavorites()

  if (!favorites || favorites.length === 0) {
    favoriteAnimes.innerHTML = '<div class="favorites-empty">Você ainda não adicionou nenhum anime aos favoritos.</div>'
    return
  }

  let html = ""

  favorites.forEach((anime) => {
    html += `
      <div class="anime-card" data-id="${anime.id}">
        <img src="${anime.image}" alt="${anime.title}" class="anime-image">
        <div class="anime-info">
          <h3 class="anime-title">${anime.title}</h3>
          <div class="anime-details">
            <span>${anime.type || "TV"}</span>
            <span>${anime.score ? anime.score + "★" : "N/A"}</span>
          </div>
        </div>
      </div>
    `
  })

  favoriteAnimes.innerHTML = html

  favoriteAnimes.querySelectorAll(".anime-card").forEach((card) => {
    card.addEventListener("click", () => {
      const animeId = card.dataset.id
      this.showAnimeDetails(animeId)
    })
  })
}
}

// Inicializar o gerenciador de autenticação
window.authManager = new AuthManager()

// Inicializar o gerenciador de páginas
window.pageManager = new PageManager()
</script>
